[    1.7559][cube-solver-1][warning] There is no solution for current loc (2).
[    1.9015][cube-solver-0][warning] There is no solution for current loc (2).

------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/textbook/tables/9-1.txt", col_types = cols(ID_class = col_character(),ID_key = col_character(),Room = col_character()))
input1 <- copy_to(con, input1)
input2 <- read_csv("tests-examples/textbook/tables/9-2.txt", col_types = cols(ID_key = col_character(),F_name = col_character()))
input2 <- copy_to(con, input2)
expected_output <- read_csv("tests-examples/textbook/tables/9.out", col_types = cols(F_name = col_character(),n = col_integer()))

df3 <- inner_join(input2, input1)
df4 <- df3 %>% group_by(F_name) %>% summarise(n = n()) %>% ungroup()
df5 <- df3 %>% filter(Room != 'R128')
df6 <- anti_join(df4, df5)
out <- df6 %>% select(F_name, n)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `F_name`,
       `n`
FROM
  (SELECT *
   FROM
     (SELECT `F_name`,
             COUNT() AS `n`
      FROM
        (SELECT `ID_key`,
                `F_name`,
                `ID_class`,
                `Room`
         FROM `input2` AS `LHS`
         INNER JOIN `input1` AS `RHS` ON (`LHS`.`ID_key` = `RHS`.`ID_key`))
      GROUP BY `F_name`) AS `LHS`
   WHERE NOT EXISTS
       (SELECT 1
        FROM
          (SELECT *
           FROM
             (SELECT `ID_key`,
                     `F_name`,
                     `ID_class`,
                     `Room`
              FROM `input2` AS `LHS`
              INNER JOIN `input1` AS `RHS` ON (`LHS`.`ID_key` = `RHS`.`ID_key`))
           WHERE (`Room` != 'R128')) AS `RHS`
        WHERE (`LHS`.`F_name` = `RHS`.`F_name`) ))
