[   11.3160][cube-solver-2][warning] There is no solution for current loc (3).
[   11.3260][cube-solver-1][warning] There is no solution for current loc (3).
[   11.5260][cube-solver-0][warning] There is no solution for current loc (3).

------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/55-tests/tables/aircraft.txt", col_types = cols(aid = col_integer(),aname = col_character(),crusingrange = col_integer()))
input1 <- copy_to(con, input1)
input2 <- read_csv("tests-examples/55-tests/tables/certified.txt", col_types = cols(eid = col_integer(),aid = col_integer()))
input2 <- copy_to(con, input2)
expected_output <- read_csv("tests-examples/55-tests/tables/25.out", col_types = cols(eid = col_integer()))

df3 <- input2 %>% group_by(eid) %>% summarise(n = n()) %>% ungroup()
df4 <- inner_join(input2, input1) %>% inner_join(df3)
df5 <- df4 %>% filter(n > 3 | n >= crusingrange)
df6 <- df5 %>% group_by(eid) %>% summarise(crusingrange = max(crusingrange)) %>% ungroup()
out <- df6 %>% select(eid)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `eid`
FROM
  (SELECT `eid`,
          MAX(`crusingrange`) AS `crusingrange`
   FROM
     (SELECT *
      FROM
        (SELECT `eid`,
                `aid`,
                `aname`,
                `crusingrange`,
                `n`
         FROM
           (SELECT `eid`,
                   `aid`,
                   `aname`,
                   `crusingrange`
            FROM `input2` AS `LHS`
            INNER JOIN `input1` AS `RHS` ON (`LHS`.`aid` = `RHS`.`aid`)) AS `LHS`
         INNER JOIN
           (SELECT `eid`,
                   COUNT() AS `n`
            FROM `input2`
            GROUP BY `eid`) AS `RHS` ON (`LHS`.`eid` = `RHS`.`eid`))
      WHERE (`n` > 3.0
             OR `n` >= `crusingrange`))
   GROUP BY `eid`)
