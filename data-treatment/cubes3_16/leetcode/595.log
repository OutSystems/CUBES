
------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/leetcode/tables/595.csv", col_types = cols(name = col_character(),continent = col_character(),area = col_integer(),population = col_integer(),gdp = col_integer()))
input1 <- copy_to(con, input1)
expected_output <- read_csv("tests-examples/leetcode/tables/595_o.csv", col_types = cols(name = col_character(),area = col_integer(),population = col_integer()))

df2 <- semi_join(input1, input1)
df3 <- df2 %>% filter(population > 3000000 & population > 25000000)
out <- df3 %>% select(name, area, population)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `name`,
       `area`,
       `population`
FROM
  (SELECT *
   FROM `input1` AS `LHS`
   WHERE EXISTS
       (SELECT 1
        FROM `input1` AS `RHS`
        WHERE (`LHS`.`name` = `RHS`.`name`
               AND `LHS`.`continent` = `RHS`.`continent`
               AND `LHS`.`area` = `RHS`.`area`
               AND `LHS`.`population` = `RHS`.`population`
               AND `LHS`.`gdp` = `RHS`.`gdp`) ))
WHERE (`population` > 3000000.0
       AND `population` > 25000000.0)
