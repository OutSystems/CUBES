
------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/scythe/top_rated_posts/tables/i027.csv", col_types = cols(cname = col_character(),wmname = col_character(),avg = col_double()))
input1 <- copy_to(con, input1)
expected_output <- read_csv("tests-examples/scythe/top_rated_posts/tables/o027.csv", col_types = cols(cname = col_character(),wmname = col_character(),maxavg = col_double()))

df2 <- input1 %>% group_by(cname) %>% summarise(avg = max(avg)) %>% ungroup()
df3 <- inner_join(input1, df2)
out <- df3 %>% select(cname, wmname, maxavg = avg)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `cname`,
       `wmname`,
       `avg` AS `maxavg`
FROM
  (SELECT `cname`,
          `wmname`,
          `avg`
   FROM `input1` AS `LHS`
   INNER JOIN
     (SELECT `cname`,
             MAX(`avg`) AS `avg`
      FROM `input1`
      GROUP BY `cname`) AS `RHS` ON (`LHS`.`cname` = `RHS`.`cname`
                                     AND `LHS`.`avg` = `RHS`.`avg`))
