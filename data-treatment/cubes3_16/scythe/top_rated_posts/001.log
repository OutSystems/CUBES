
------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/scythe/top_rated_posts/tables/i001.csv", col_types = cols(SubjectID = col_integer(),StudentName = col_character()))
input1 <- copy_to(con, input1)
expected_output <- read_csv("tests-examples/scythe/top_rated_posts/tables/o001.csv", col_types = cols(SubjectID = col_integer(),concatStudentName = col_character()))

string_agg <- function(v,s) {Reduce(function(x, y) paste(x, y, sep = s), v)}

df2 <- input1 %>% group_by(SubjectID) %>% summarise(concatStudentName = string_agg(StudentName, ', ')) %>% ungroup()
out <- df2 %>% select(SubjectID, concatStudentName)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `SubjectID`,
       `concatStudentName`
FROM
  (SELECT `SubjectID`,
          string_agg(`StudentName`, ', ') AS `concatStudentName`
   FROM `input1`
   GROUP BY `SubjectID`)
