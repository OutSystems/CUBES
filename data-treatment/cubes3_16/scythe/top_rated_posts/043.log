
------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/scythe/top_rated_posts/tables/i043.csv", col_types = cols(CustomerName = col_character(),EmailAddress = col_character()))
input1 <- copy_to(con, input1)
expected_output <- read_csv("tests-examples/scythe/top_rated_posts/tables/o043.csv", col_types = cols(CustomerName = col_character(),EmailAddress = col_character()))

df2 <- input1 %>% group_by(EmailAddress) %>% summarise(n = n()) %>% ungroup()
df3 <- df2 %>% filter(n > 1)
df4 <- inner_join(input1, df3)
out <- df4 %>% select(CustomerName, EmailAddress)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `CustomerName`,
       `EmailAddress`
FROM
  (SELECT `CustomerName`,
          `EmailAddress`,
          `n`
   FROM `input1` AS `LHS`
   INNER JOIN
     (SELECT *
      FROM
        (SELECT `EmailAddress`,
                COUNT() AS `n`
         FROM `input1`
         GROUP BY `EmailAddress`)
      WHERE (`n` > 1.0)) AS `RHS` ON (`LHS`.`EmailAddress` = `RHS`.`EmailAddress`))
