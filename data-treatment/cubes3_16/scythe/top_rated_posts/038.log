
------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/scythe/top_rated_posts/tables/i038.csv", col_types = cols(id = col_integer(),name = col_character(),city = col_character()))
input1 <- copy_to(con, input1)
expected_output <- read_csv("tests-examples/scythe/top_rated_posts/tables/o038.csv", col_types = cols(id = col_integer(),name = col_character(),city = col_character()))

df2 <- input1 %>% group_by(city, name) %>% summarise(n = n()) %>% ungroup()
df3 <- inner_join(input1, df2)
df4 <- df3 %>% filter(n > 1)
out <- df4 %>% select(id, name, city)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `id`,
       `name`,
       `city`
FROM
  (SELECT `id`,
          `name`,
          `city`,
          `n`
   FROM `input1` AS `LHS`
   INNER JOIN
     (SELECT `city`,
             `name`,
             COUNT() AS `n`
      FROM `input1`
      GROUP BY `city`,
               `name`) AS `RHS` ON (`LHS`.`name` = `RHS`.`name`
                                    AND `LHS`.`city` = `RHS`.`city`))
WHERE (`n` > 1.0)
