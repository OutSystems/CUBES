[    1.5778][cube-solver-0][warning] There is no solution for current loc (1).

------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/scythe/top_rated_posts/tables/i028_1.csv", col_types = cols(PID = col_character()))
input1 <- copy_to(con, input1)
input2 <- read_csv("tests-examples/scythe/top_rated_posts/tables/i028_2.csv", col_types = cols(PID = col_character(),SEQ = col_integer(),Desc = col_character()))
input2 <- copy_to(con, input2)
expected_output <- read_csv("tests-examples/scythe/top_rated_posts/tables/o028.csv", col_types = cols(PID = col_character(),concatDesc = col_character()))

string_agg <- function(v,s) {Reduce(function(x, y) paste(x, y, sep = s), v)}

df3 <- semi_join(input2, input1)
df4 <- df3 %>% group_by(PID) %>% summarise(concatDesc = string_agg(Desc, ' ')) %>% ungroup()
out <- df4 %>% select(PID, concatDesc)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `PID`,
       `concatDesc`
FROM
  (SELECT `PID`,
          string_agg(`Desc`, ' ') AS `concatDesc`
   FROM
     (SELECT *
      FROM `input2` AS `LHS`
      WHERE EXISTS
          (SELECT 1
           FROM `input1` AS `RHS`
           WHERE (`LHS`.`PID` = `RHS`.`PID`) ))
   GROUP BY `PID`)
