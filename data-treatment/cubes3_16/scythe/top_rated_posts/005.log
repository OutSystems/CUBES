[   44.0167][cube-solver-0][warning] There is no solution for current loc (2).

------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/scythe/top_rated_posts/tables/i005.csv", col_types = cols(id = col_integer(),customer = col_character(),total = col_integer()))
input1 <- copy_to(con, input1)
expected_output <- read_csv("tests-examples/scythe/top_rated_posts/tables/o005.csv", col_types = cols(minid = col_integer(),customer = col_character(),maxtotal = col_integer()))

df2 <- input1 %>% group_by(total) %>% summarise(id = min(id)) %>% ungroup()
df3 <- input1 %>% group_by(customer) %>% summarise(total = max(total)) %>% ungroup()
df4 <- inner_join(input1, df2) %>% inner_join(df3)
out <- df4 %>% select(minid = id, customer, maxtotal = total)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `id` AS `minid`,
       `customer`,
       `total` AS `maxtotal`
FROM
  (SELECT `id`,
          `customer`,
          `total`
   FROM
     (SELECT `id`,
             `customer`,
             `total`
      FROM `input1` AS `LHS`
      INNER JOIN
        (SELECT `total`,
                MIN(`id`) AS `id`
         FROM `input1`
         GROUP BY `total`) AS `RHS` ON (`LHS`.`id` = `RHS`.`id`
                                        AND `LHS`.`total` = `RHS`.`total`)) AS `LHS`
   INNER JOIN
     (SELECT `customer`,
             MAX(`total`) AS `total`
      FROM `input1`
      GROUP BY `customer`) AS `RHS` ON (`LHS`.`customer` = `RHS`.`customer`
                                        AND `LHS`.`total` = `RHS`.`total`))
