
------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/scythe/recent_posts/tables/025.csv", col_types = cols(id = col_integer(),gallery_id = col_double(),path = col_character()))
input1 <- copy_to(con, input1)
expected_output <- read_csv("tests-examples/scythe/recent_posts/tables/025_o.csv", col_types = cols(id = col_integer(),gallery_id = col_double(),path = col_character()))

df2 <- input1 %>% group_by(gallery_id) %>% summarise(minid = min(id)) %>% ungroup()
df3 <- inner_join(input1, df2)
df4 <- df3 %>% filter(is.na(gallery_id) | minid == id)
out <- df4 %>% select(id, gallery_id, path)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `id`,
       `gallery_id`,
       `path`
FROM
  (SELECT `id`,
          `gallery_id`,
          `path`,
          `minid`
   FROM `input1` AS `LHS`
   INNER JOIN
     (SELECT `gallery_id`,
             MIN(`id`) AS `minid`
      FROM `input1`
      GROUP BY `gallery_id`) AS `RHS` ON (`LHS`.`gallery_id` = `RHS`.`gallery_id`))
WHERE (((`gallery_id`) IS NULL)
       OR `minid` = `id`)
