[     3.332][MainProcess][INFO] Parsing specification...
[     3.337][MainProcess][DEBUG] Reading input files...
[     3.345][MainProcess][INFO] Inferred data types for table tests-examples/scythe/recent_posts/tables/014_1.csv: ['int64', 'string', 'int64']
[     3.350][MainProcess][INFO] Inferred data types for table tests-examples/scythe/recent_posts/tables/014_2.csv: ['int64', 'string', 'int64']
[     3.356][MainProcess][INFO] Inferred data types for table tests-examples/scythe/recent_posts/tables/014_o.csv: ['int64', 'string', 'int64']
[     3.386][MainProcess][DEBUG] Generating DSL...
[     3.404][MainProcess][INFO] Creating 8 processes
[     3.451][cube-solver-0][DEBUG] Initialising process for 1 lines of code.
[     3.452][cube-solver-1][DEBUG] Initialising process for 1 lines of code.
[     3.454][cube-solver-2][DEBUG] Initialising process for 1 lines of code.
[     3.461][cube-solver-3][DEBUG] Initialising process for 1 lines of code.
[     3.462][cube-solver-4][DEBUG] Initialising process for 1 lines of code.
[     3.469][cube-solver-6][DEBUG] Initialising process for 1 lines of code.
[     3.470][cube-solver-5][DEBUG] Initialising process for 1 lines of code.
[     3.477][cube-solver-7][DEBUG] Initialising process for 1 lines of code.
[     3.526][cube-solver-2][DEBUG] Solving cube (l0 = natural_join4(),)
[     3.529][cube-solver-2][DEBUG] Solving cube (l0 = cross_join(),)
[     3.533][cube-solver-1][DEBUG] Solving cube (l0 = natural_join3(),)
[     3.532][cube-solver-4][DEBUG] Solving cube (l0 = left_join(),)
[     3.534][cube-solver-1][DEBUG] Solving cube (l0 = inner_join(),)
[     3.540][cube-solver-6][DEBUG] Solving cube (l0 = intersect(),)
[     3.546][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(),)
[     3.547][cube-solver-3][DEBUG] Solving cube (l0 = anti_join(),)
[     3.554][MainProcess][DEBUG] Increasing generator loc to 2
[     3.554][cube-solver-2][DEBUG] Initialising process for 2 lines of code.
[     3.559][cube-solver-5][DEBUG] Solving cube (l0 = union(),)
[     3.571][cube-solver-7][DEBUG] Solving cube (l0 = semi_join(),)
[     3.734][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = anti_join([6]))
[     3.739][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = left_join())
[     3.820][cube-solver-7][DEBUG] Initialising process for 2 lines of code.
[     3.838][cube-solver-6][DEBUG] Initialising process for 2 lines of code.
[     4.007][cube-solver-7][DEBUG] Solving cube (l0 = natural_join(), l1 = union())
[     4.012][cube-solver-6][DEBUG] Solving cube (l0 = natural_join(), l1 = intersect([8]))
[     4.309][cube-solver-0][DEBUG] Initialising process for 2 lines of code.
[     4.319][cube-solver-5][DEBUG] Initialising process for 2 lines of code.
[     4.366][cube-solver-4][DEBUG] Initialising process for 2 lines of code.
[     4.476][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(), l1 = semi_join())
[     4.485][cube-solver-5][DEBUG] Solving cube (l0 = natural_join(), l1 = cross_join([2]))
[     4.508][cube-solver-3][DEBUG] Initialising process for 2 lines of code.
[     4.547][cube-solver-4][DEBUG] Solving cube (l0 = natural_join(), l1 = inner_join([5]))
[     4.572][cube-solver-5][DEBUG] Solving cube (l0 = natural_join(), l1 = natural_join3())
[     4.574][cube-solver-5][DEBUG] Solving cube (l0 = natural_join(), l1 = natural_join4())
[     4.575][cube-solver-5][DEBUG] Solving cube (l0 = natural_join3(), l1 = anti_join([14]))
[     4.582][cube-solver-5][DEBUG] Solving cube (l0 = natural_join3(), l1 = left_join())
[     4.584][cube-solver-5][DEBUG] Solving cube (l0 = natural_join3(), l1 = union())
[     4.585][cube-solver-5][DEBUG] Solving cube (l0 = natural_join3(), l1 = intersect([8]))
[     4.589][cube-solver-5][DEBUG] Solving cube (l0 = natural_join3(), l1 = semi_join())
[     4.590][cube-solver-5][DEBUG] Solving cube (l0 = natural_join3(), l1 = cross_join([2]))
[     4.593][cube-solver-5][DEBUG] Solving cube (l0 = natural_join3(), l1 = inner_join([5]))
[     4.596][cube-solver-5][DEBUG] Solving cube (l0 = natural_join3(), l1 = natural_join())
[     4.597][cube-solver-5][DEBUG] Solving cube (l0 = natural_join3(), l1 = natural_join3())
[     4.598][cube-solver-5][DEBUG] Solving cube (l0 = natural_join3(), l1 = natural_join4())
[     4.600][cube-solver-5][DEBUG] Solving cube (l0 = natural_join4(), l1 = anti_join([14]))
[     4.607][cube-solver-5][DEBUG] Solving cube (l0 = natural_join4(), l1 = left_join())
[     4.608][cube-solver-5][DEBUG] Solving cube (l0 = natural_join4(), l1 = union())
[     4.610][cube-solver-5][DEBUG] Solving cube (l0 = natural_join4(), l1 = intersect([8]))
[     4.614][cube-solver-5][DEBUG] Solving cube (l0 = natural_join4(), l1 = semi_join())
[     4.615][cube-solver-5][DEBUG] Solving cube (l0 = natural_join4(), l1 = cross_join([2]))
[     4.617][cube-solver-5][DEBUG] Solving cube (l0 = natural_join4(), l1 = inner_join([5]))
[     4.621][cube-solver-5][DEBUG] Solving cube (l0 = natural_join4(), l1 = natural_join())
[     4.622][cube-solver-5][DEBUG] Solving cube (l0 = natural_join4(), l1 = natural_join3())
[     4.623][cube-solver-5][DEBUG] Solving cube (l0 = natural_join4(), l1 = natural_join4())
[     4.624][cube-solver-5][DEBUG] Solving cube (l0 = anti_join([14]), l1 = natural_join())
[     4.676][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = natural_join())
[     4.717][cube-solver-6][DEBUG] Solving cube (l0 = anti_join([14]), l1 = natural_join3())
[     4.725][cube-solver-6][DEBUG] Solving cube (l0 = anti_join([14]), l1 = natural_join4())
[     4.733][cube-solver-6][DEBUG] Solving cube (l0 = anti_join([14]), l1 = anti_join([14]))
[     4.746][cube-solver-6][DEBUG] Solving cube (l0 = anti_join([14]), l1 = left_join())
[     6.897][cube-solver-0][DEBUG] Solving cube (l0 = anti_join([14]), l1 = union())
[     7.354][cube-solver-2][DEBUG] Solving cube (l0 = anti_join([14]), l1 = intersect([8]))
[     7.456][cube-solver-3][DEBUG] Solving cube (l0 = anti_join([14]), l1 = semi_join())
[     7.616][cube-solver-7][DEBUG] Solving cube (l0 = anti_join([14]), l1 = cross_join([2]))
[     7.938][cube-solver-7][DEBUG] Solving cube (l0 = anti_join([14]), l1 = inner_join([18]))
[    10.269][cube-solver-2][DEBUG] Solving cube (l0 = left_join(), l1 = natural_join())
[    11.121][cube-solver-3][DEBUG] Solving cube (l0 = left_join(), l1 = natural_join3())
[    11.258][cube-solver-5][DEBUG] Solving cube (l0 = left_join(), l1 = natural_join4())
[    11.260][cube-solver-5][DEBUG] Solving cube (l0 = left_join(), l1 = anti_join([14]))
[    12.719][cube-solver-6][DEBUG] Solving cube (l0 = left_join(), l1 = left_join())
[    14.152][cube-solver-0][DEBUG] Solving cube (l0 = left_join(), l1 = union())
[    14.529][cube-solver-2][DEBUG] Solving cube (l0 = left_join(), l1 = intersect([8]))
[    15.530][cube-solver-2][DEBUG] Solving cube (l0 = left_join(), l1 = semi_join())
[    17.484][cube-solver-6][DEBUG] Solving cube (l0 = left_join(), l1 = cross_join([2]))
[    17.643][cube-solver-6][DEBUG] Solving cube (l0 = left_join(), l1 = inner_join([55]))
[    18.322][cube-solver-2][DEBUG] Solving cube (l0 = union(), l1 = natural_join())
[    18.686][cube-solver-0][DEBUG] Solving cube (l0 = union(), l1 = natural_join3())
[    19.244][cube-solver-3][DEBUG] Solving cube (l0 = union(), l1 = natural_join4())
[    19.246][cube-solver-3][DEBUG] Solving cube (l0 = union(), l1 = anti_join([14]))
[    22.396][cube-solver-2][DEBUG] Solving cube (l0 = union(), l1 = left_join())
[    24.969][cube-solver-5][DEBUG] Solving cube (l0 = union(), l1 = union())
[    25.943][cube-solver-1][DEBUG] Initialising process for 2 lines of code.
[    26.150][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = intersect([8]))
[    26.542][cube-solver-0][DEBUG] Solving cube (l0 = union(), l1 = semi_join())
[    27.154][cube-solver-2][DEBUG] Solving cube (l0 = union(), l1 = cross_join([2]))
[    27.204][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = inner_join([74]))
[    27.272][cube-solver-2][DEBUG] Solving cube (l0 = intersect([8]), l1 = natural_join())
[    28.162][cube-solver-2][DEBUG] Solving cube (l0 = intersect([10]), l1 = natural_join3())
[    29.270][cube-solver-0][DEBUG] Solving cube (l0 = intersect([10]), l1 = natural_join4())
[    29.276][cube-solver-0][DEBUG] Solving cube (l0 = intersect([10]), l1 = anti_join([14]))
[    29.601][cube-solver-5][DEBUG] Solving cube (l0 = intersect([10]), l1 = left_join())
[    30.458][cube-solver-5][DEBUG] Solving cube (l0 = intersect([10]), l1 = union())
[    31.791][cube-solver-0][DEBUG] Solving cube (l0 = intersect([10]), l1 = intersect([10]))
[    32.486][cube-solver-5][DEBUG] Solving cube (l0 = intersect([10]), l1 = semi_join())
[    32.815][cube-solver-0][DEBUG] Solving cube (l0 = intersect([10]), l1 = cross_join([2]))
[    32.964][cube-solver-0][DEBUG] Solving cube (l0 = intersect([10]), l1 = inner_join([74]))
[    32.971][cube-solver-5][DEBUG] Solving cube (l0 = semi_join(), l1 = natural_join())
[    33.370][cube-solver-3][DEBUG] Solving cube (l0 = semi_join(), l1 = natural_join3())
[    35.925][cube-solver-5][DEBUG] Solving cube (l0 = semi_join(), l1 = natural_join4())
[    35.927][cube-solver-5][DEBUG] Solving cube (l0 = semi_join(), l1 = anti_join([14]))
[    39.087][cube-solver-2][DEBUG] Solving cube (l0 = semi_join(), l1 = left_join())
[    41.498][cube-solver-3][DEBUG] Solving cube (l0 = semi_join(), l1 = union())
[    42.005][cube-solver-5][DEBUG] Solving cube (l0 = semi_join(), l1 = intersect([10]))
[    42.433][cube-solver-2][DEBUG] Solving cube (l0 = semi_join(), l1 = semi_join())
[    42.967][cube-solver-5][DEBUG] Solving cube (l0 = semi_join(), l1 = cross_join([2]))
[    43.070][cube-solver-5][DEBUG] Solving cube (l0 = semi_join(), l1 = inner_join([74]))
[    43.746][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([2]), l1 = natural_join())
[    43.787][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([4]), l1 = natural_join3())
[    43.791][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([4]), l1 = natural_join4())
[    43.795][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([4]), l1 = anti_join([14]))
[    43.806][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([4]), l1 = left_join())
[    43.810][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([4]), l1 = union())
[    43.814][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([4]), l1 = intersect([10]))
[    43.823][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([4]), l1 = semi_join())
[    43.827][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([4]), l1 = cross_join([4]))
[    43.836][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([4]), l1 = inner_join([74]))
[    43.877][cube-solver-2][DEBUG] Solving cube (l0 = inner_join([74]), l1 = natural_join())
[    44.755][cube-solver-3][DEBUG] Solving cube (l0 = inner_join([74]), l1 = natural_join3())
[    45.561][cube-solver-0][DEBUG] Solving cube (l0 = inner_join([74]), l1 = natural_join4())
[    45.594][cube-solver-0][DEBUG] Solving cube (l0 = inner_join([74]), l1 = anti_join([14]))
[   197.223][cube-solver-5][DEBUG] Solving cube (l0 = inner_join([147]), l1 = left_join())
[   245.594][cube-solver-2][DEBUG] Solving cube (l0 = inner_join([148]), l1 = union())
[   358.332][cube-solver-2][DEBUG] Found solution with cube (l0 = inner_join([148]), l1 = union())
[   358.335][MainProcess][INFO] Statistics:
[   358.336][MainProcess][INFO] 	Generated cubes: 106
[   358.336][MainProcess][INFO] 	Attempted programs: 3630
[   358.336][MainProcess][INFO] 		Rejected: 1526
[   358.336][MainProcess][INFO] 		Failed: 2103
[   358.336][MainProcess][INFO] 	Blacklist clauses: 176
[   358.337][MainProcess][DEBUG] Printing statistics for good programs of size 1
[   358.341][MainProcess][DEBUG] 	0: Counter({'inner_join': 3168, 'left_join': 96, 'natural_join': 96, 'union': 96, 'anti_join': 96, 'semi_join': 24})
[   358.341][MainProcess][DEBUG] Printing statistics for good programs of size 2
[   358.522][MainProcess][DEBUG] 	0: Counter({'inner_join': 159309, 'left_join': 56284, 'natural_join': 55139, 'union': 54674, 'anti_join': 53817, 'semi_join': 25560, 'intersect': 2640})
[   358.645][MainProcess][DEBUG] 	1: Counter({'inner_join': 226689, 'natural_join3': 50461, 'anti_join': 47556, 'natural_join': 33024, 'left_join': 27475, 'union': 20429, 'semi_join': 1800})
[   358.645][MainProcess][INFO] Solution found: union(inner_join(@param0, @param1, 'PARENT_ID' = 'ID'), @param1)
[   359.065][MainProcess][ERROR] Error while trying to convert R code to SQL.

------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/scythe/recent_posts/tables/014_1.csv", col_types = cols(ID = col_integer(),NAME = col_character(),PARENT_ID = col_integer()))
input1 <- copy_to(con, input1)
input2 <- read_csv("tests-examples/scythe/recent_posts/tables/014_2.csv", col_types = cols(ID = col_integer(),NAME = col_character(),UNIQUE_ID = col_integer()))
input2 <- copy_to(con, input2)
expected_output <- read_csv("tests-examples/scythe/recent_posts/tables/014_o.csv", col_types = cols(ID = col_integer(),NAME = col_character(),PARENT_ID = col_integer()))

df3 <- inner_join(input1, input2, by=c('PARENT_ID' = 'ID'), suffix = c('', '.other'))
df4 <- bind_rows(df3, input2)
out <- df4 %>% select(ID, NAME, PARENT_ID = UNIQUE_ID) %>% arrange(ID)

Failed to generate SQL query
