[     1.711][MainProcess][INFO] Parsing specification...
[     1.716][MainProcess][DEBUG] Reading input files...
[     1.735][MainProcess][INFO] Inferred data types for table tests-examples/scythe/recent_posts/tables/028.csv: ['int64', 'string']
[     1.740][MainProcess][INFO] Inferred data types for table tests-examples/scythe/recent_posts/tables/028_o.csv: ['int64', 'int64']
[     1.767][MainProcess][DEBUG] Generating DSL...
[     1.956][MainProcess][INFO] Creating 16 processes
[     2.024][MainProcess][DEBUG] Increasing generator loc to 3
[     2.169][cube-solver-1][DEBUG] Initialising process for 2 lines of code.
[     2.182][cube-solver-3][DEBUG] Initialising process for 2 lines of code.
[     2.185][cube-solver-4][DEBUG] Initialising process for 3 lines of code.
[     2.188][cube-solver-5][DEBUG] Initialising process for 3 lines of code.
[     2.193][cube-solver-6][DEBUG] Initialising process for 3 lines of code.
[     2.199][cube-solver-0][DEBUG] Initialising process for 2 lines of code.
[     2.201][cube-solver-8][DEBUG] Initialising process for 3 lines of code.
[     2.205][cube-solver-9][DEBUG] Initialising process for 3 lines of code.
[     2.207][cube-solver-2][DEBUG] Initialising process for 2 lines of code.
[     2.213][cube-solver-10][DEBUG] Initialising process for 3 lines of code.
[     2.231][cube-solver-11][DEBUG] Initialising process for 3 lines of code.
[     2.233][cube-solver-12][DEBUG] Initialising process for 3 lines of code.
[     2.241][cube-solver-14][DEBUG] Initialising process for 3 lines of code.
[     2.246][cube-solver-7][DEBUG] Initialising process for 3 lines of code.
[     2.248][cube-solver-13][DEBUG] Initialising process for 3 lines of code.
[     2.301][cube-solver-15][DEBUG] Initialising process for 3 lines of code.
[     9.766][cube-solver-1][DEBUG] Solving cube (l0 = filter(), l1 = summarise())
[     9.769][cube-solver-2][DEBUG] Solving cube (l0 = filter(), l1 = mutate())
[     9.785][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter())
[     9.797][cube-solver-0][DEBUG] Solving cube (l0 = summarise(), l1 = filter())
[    10.378][cube-solver-2][DEBUG] Initialising process for 3 lines of code.
[    10.716][cube-solver-1][DEBUG] Initialising process for 3 lines of code.
[    15.398][cube-solver-9][DEBUG] Solving cube (l0 = natural_join3(), l1 = filter(), l2 = summarise())
[    15.412][cube-solver-6][DEBUG] Solving cube (l0 = natural_join(), l1 = filter(), l2 = mutate())
[    15.445][cube-solver-9][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join4(), l2 = filter())
[    15.444][cube-solver-12][DEBUG] Solving cube (l0 = natural_join4(), l1 = summarise(), l2 = filter())
[    15.475][cube-solver-9][DEBUG] Solving cube (l0 = summarise(), l1 = summarise(), l2 = filter())
[    15.478][cube-solver-11][DEBUG] Solving cube (l0 = natural_join3(), l1 = mutate(), l2 = filter())
[    15.479][cube-solver-5][DEBUG] Solving cube (l0 = natural_join(), l1 = filter(), l2 = summarise())
[    15.482][cube-solver-8][DEBUG] Solving cube (l0 = natural_join3(), l1 = summarise(), l2 = filter())
[    15.485][cube-solver-4][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise(), l2 = filter())
[    15.480][cube-solver-10][DEBUG] Solving cube (l0 = natural_join3(), l1 = filter(), l2 = mutate())
[    15.491][cube-solver-14][DEBUG] Solving cube (l0 = natural_join4(), l1 = filter(), l2 = mutate())
[    15.503][cube-solver-9][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = natural_join())
[    15.552][cube-solver-5][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = natural_join4())
[    15.553][cube-solver-11][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = summarise())
[    15.554][cube-solver-15][DEBUG] Solving cube (l0 = natural_join4(), l1 = mutate(), l2 = filter())
[    15.596][cube-solver-6][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = natural_join3())
[    15.607][cube-solver-5][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = semi_join())
[    15.626][cube-solver-12][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = filter())
[    15.671][cube-solver-8][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = anti_join())
[    15.672][cube-solver-4][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = union())
[    15.673][cube-solver-10][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = left_join())
[    15.680][cube-solver-14][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = intersect())
[    15.736][cube-solver-15][DEBUG] Solving cube (l0 = summarise(), l1 = filter(), l2 = cross_join())
[    15.810][cube-solver-7][DEBUG] Solving cube (l0 = natural_join(), l1 = mutate(), l2 = filter([2]))
[    15.840][cube-solver-13][DEBUG] Solving cube (l0 = natural_join4(), l1 = filter([2]), l2 = summarise())
[    15.876][cube-solver-7][DEBUG] Solving cube (l0 = summarise(), l1 = filter([2]), l2 = mutate())
[    15.922][cube-solver-13][DEBUG] Solving cube (l0 = summarise(), l1 = filter([2]), l2 = inner_join())
[    23.042][cube-solver-2][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join(), l2 = filter([76]))
[    24.840][cube-solver-1][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join3(), l2 = filter([86]))
[    24.953][cube-solver-1][DEBUG] Solving cube (l0 = summarise(), l1 = anti_join(), l2 = filter([86]))
[    25.673][cube-solver-3][DEBUG] Initialising process for 3 lines of code.
[    35.298][cube-solver-0][DEBUG] Initialising process for 3 lines of code.
[    39.431][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = left_join(), l2 = filter([151]))
[    44.385][cube-solver-7][DEBUG] Solving cube (l0 = summarise(), l1 = intersect(), l2 = filter([154]))
[    48.194][cube-solver-0][DEBUG] Solving cube (l0 = summarise(), l1 = union(), l2 = filter([155]))
[    73.568][cube-solver-11][DEBUG] Solving cube (l0 = summarise(), l1 = semi_join(), l2 = filter([155]))
[   126.962][cube-solver-2][DEBUG] Solving cube (l0 = summarise(), l1 = cross_join(), l2 = filter([155]))
[   129.915][cube-solver-7][DEBUG] Solving cube (l0 = summarise(), l1 = mutate(), l2 = filter([155]))
[   142.838][cube-solver-11][DEBUG] Solving cube (l0 = summarise(), l1 = inner_join(), l2 = filter([155]))
[   158.433][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = natural_join(), l2 = summarise())
[   160.664][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = natural_join(), l2 = mutate())
[   161.850][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = natural_join3(), l2 = summarise())
[   161.942][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = natural_join3(), l2 = mutate())
[   162.026][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = natural_join4(), l2 = summarise())
[   162.119][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = natural_join4(), l2 = mutate())
[   162.206][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = natural_join())
[   168.766][cube-solver-9][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = natural_join3())
[   169.466][cube-solver-5][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = natural_join4())
[   169.551][cube-solver-5][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = summarise())
[   169.635][cube-solver-5][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = filter([155]))
[   171.883][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = anti_join())
[   172.017][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = left_join())
[   178.935][cube-solver-0][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = union())
[   182.983][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = intersect())
[   184.345][cube-solver-14][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = semi_join())
[   188.717][cube-solver-9][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = cross_join())
[   189.768][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = mutate())
[   190.008][cube-solver-0][DEBUG] Solving cube (l0 = filter([155]), l1 = summarise(), l2 = inner_join())
[   190.034][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = filter([155]), l2 = summarise())
[   190.902][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = filter([155]), l2 = mutate())
[   190.961][cube-solver-14][DEBUG] Solving cube (l0 = filter([155]), l1 = anti_join(), l2 = summarise())
[   193.581][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = anti_join(), l2 = mutate())
[   195.173][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = left_join(), l2 = summarise())
[   197.338][cube-solver-4][DEBUG] Solving cube (l0 = filter([155]), l1 = left_join(), l2 = mutate())
[   197.760][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = union(), l2 = summarise())
[   198.207][cube-solver-10][DEBUG] Solving cube (l0 = filter([155]), l1 = union(), l2 = mutate())
[   198.340][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = intersect(), l2 = summarise())
[   198.988][cube-solver-4][DEBUG] Solving cube (l0 = filter([155]), l1 = intersect(), l2 = mutate())
[   199.273][cube-solver-14][DEBUG] Solving cube (l0 = filter([155]), l1 = semi_join(), l2 = summarise())
[   199.935][cube-solver-10][DEBUG] Solving cube (l0 = filter([155]), l1 = semi_join(), l2 = mutate())
[   200.395][cube-solver-4][DEBUG] Solving cube (l0 = filter([155]), l1 = cross_join(), l2 = summarise())
[   200.937][cube-solver-7][DEBUG] Solving cube (l0 = filter([155]), l1 = cross_join(), l2 = mutate())
[   201.410][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = natural_join())
[   201.642][cube-solver-10][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = natural_join3())
[   202.502][cube-solver-14][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = natural_join4())
[   202.638][cube-solver-14][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = summarise())
[   203.729][cube-solver-14][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = filter([155]))
[   204.622][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = anti_join())
[   208.221][cube-solver-10][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = left_join())
[   212.009][cube-solver-10][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = union())
[   213.778][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = intersect())
[   215.789][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = semi_join())
[   215.823][cube-solver-10][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = cross_join())
[   218.682][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = mutate())
[   218.973][cube-solver-1][DEBUG] Solving cube (l0 = filter([155]), l1 = mutate(), l2 = inner_join())
[   219.303][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = inner_join(), l2 = summarise())
[   228.727][cube-solver-3][DEBUG] Solving cube (l0 = filter([155]), l1 = inner_join(), l2 = mutate())
[   236.001][cube-solver-3][DEBUG] Solving cube (l0 = anti_join(), l1 = summarise(), l2 = filter([155]))
[   236.084][cube-solver-3][DEBUG] Solving cube (l0 = anti_join(), l1 = filter([155]), l2 = summarise())
[   236.168][cube-solver-3][DEBUG] Solving cube (l0 = anti_join(), l1 = filter([155]), l2 = mutate())
[   236.249][cube-solver-3][DEBUG] Solving cube (l0 = anti_join(), l1 = mutate(), l2 = filter([155]))
[   236.331][cube-solver-3][DEBUG] Solving cube (l0 = left_join(), l1 = summarise(), l2 = filter([155]))
[   264.700][cube-solver-3][DEBUG] Solving cube (l0 = left_join(), l1 = filter([155]), l2 = summarise())
[   265.854][cube-solver-3][DEBUG] Solving cube (l0 = left_join(), l1 = filter([155]), l2 = mutate())
[   266.469][cube-solver-3][DEBUG] Solving cube (l0 = left_join(), l1 = mutate(), l2 = filter([155]))
[   271.205][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = summarise(), l2 = filter([155]))
[   280.855][cube-solver-0][DEBUG] Solving cube (l0 = union(), l1 = filter([155]), l2 = summarise())
[   282.010][cube-solver-0][DEBUG] Solving cube (l0 = union(), l1 = filter([155]), l2 = mutate())
[   282.612][cube-solver-0][DEBUG] Solving cube (l0 = union(), l1 = mutate(), l2 = filter([155]))
[   283.509][cube-solver-3][DEBUG] Solving cube (l0 = intersect(), l1 = summarise(), l2 = filter([155]))
[   291.460][cube-solver-14][DEBUG] Solving cube (l0 = intersect(), l1 = filter([155]), l2 = summarise())
[   292.505][cube-solver-14][DEBUG] Solving cube (l0 = intersect(), l1 = filter([155]), l2 = mutate())
[   292.978][cube-solver-14][DEBUG] Solving cube (l0 = intersect(), l1 = mutate(), l2 = filter([155]))
[   299.542][cube-solver-1][DEBUG] Solving cube (l0 = semi_join(), l1 = summarise(), l2 = filter([155]))
[   299.552][cube-solver-0][DEBUG] Solving cube (l0 = semi_join(), l1 = filter([155]), l2 = summarise())
[   300.683][cube-solver-0][DEBUG] Solving cube (l0 = semi_join(), l1 = filter([155]), l2 = mutate())
[   301.297][cube-solver-0][DEBUG] Solving cube (l0 = semi_join(), l1 = mutate(), l2 = filter([155]))
[   305.955][cube-solver-14][DEBUG] Solving cube (l0 = cross_join(), l1 = summarise(), l2 = filter([155]))
[   309.202][cube-solver-6][DEBUG] Solving cube (l0 = cross_join([32]), l1 = filter([155]), l2 = summarise())
[   311.858][cube-solver-3][DEBUG] Solving cube (l0 = cross_join([89]), l1 = filter([155]), l2 = mutate())
[   318.731][cube-solver-5][DEBUG] Solving cube (l0 = cross_join([251]), l1 = mutate(), l2 = filter([155]))
[   318.802][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join(), l2 = filter([155]))
[   328.791][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join3(), l2 = filter([155]))
[   331.653][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join4(), l2 = filter([155]))
[   332.584][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = summarise(), l2 = filter([155]))
[   356.749][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = filter([155]), l2 = natural_join())
[   361.702][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = filter([155]), l2 = natural_join3())
[   427.212][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = filter([155]), l2 = natural_join4())
[   429.007][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = filter([155]), l2 = summarise())
[   444.687][cube-solver-4][DEBUG] Found solution with cube (l0 = filter([155]), l1 = cross_join(), l2 = summarise())
[   444.879][MainProcess][INFO] Statistics:
[   444.879][MainProcess][INFO] 	Generated cubes: 121
[   444.879][MainProcess][INFO] 	Attempted programs: 61856
[   444.879][MainProcess][INFO] 		Rejected: 27170
[   444.879][MainProcess][INFO] 		Failed: 34685
[   444.879][MainProcess][INFO] 	Blacklist clauses: 2327
[   444.879][MainProcess][DEBUG] Printing statistics for good programs of size 2
[   444.884][MainProcess][DEBUG] 	0: Counter({'summarise': 2580, 'mutate': 1920, 'filter': 160})
[   444.885][MainProcess][DEBUG] 	1: Counter({'filter': 4500, 'summarise': 100, 'mutate': 60})
[   444.886][MainProcess][DEBUG] Printing statistics for good programs of size 3
[   445.061][MainProcess][DEBUG] 	0: Counter({'summarise': 375906, 'filter': 129318, 'mutate': 24890, 'cross_join': 13297, 'left_join': 4660, 'union': 4660, 'semi_join': 4660, 'intersect': 1360})
[   445.212][MainProcess][DEBUG] 	1: Counter({'filter': 278209, 'summarise': 69160, 'mutate': 58198, 'cross_join': 54760, 'inner_join': 31152, 'anti_join': 16640, 'natural_join': 15680, 'left_join': 14580, 'union': 14580, 'semi_join': 5700, 'intersect': 112})
[   445.361][MainProcess][DEBUG] 	2: Counter({'filter': 218985, 'cross_join': 100929, 'inner_join': 56808, 'natural_join3': 36312, 'anti_join': 31344, 'mutate': 29056, 'natural_join': 22560, 'union': 17500, 'left_join': 17500, 'summarise': 15135, 'semi_join': 12660})
[   445.362][MainProcess][INFO] Solution found: summarise(cross_join(@param0, filter(@param0, Member == 1), Member != Member.other & Element.other == Element), n = n(), Member)

------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/scythe/recent_posts/tables/028.csv", col_types = cols(Member = col_integer(),Element = col_character()))
input1 <- copy_to(con, input1)
expected_output <- read_csv("tests-examples/scythe/recent_posts/tables/028_o.csv", col_types = cols(c1 = col_integer(),c2 = col_integer()))

df2 <- input1 %>% filter(Member == 1)
df3 <- full_join(input1 %>% mutate(tmp.col=1), df2 %>% mutate(tmp.col=1), by="tmp.col", suffix = c("", ".other")) %>% select(-tmp.col) %>% filter(Member != Member.other & Element.other == Element)
df4 <- df3 %>% group_by(Member) %>% summarise(n = n()) %>% ungroup()
out <- df4 %>% select(c1 = Member, c2 = n) %>% arrange(c1)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT Member AS c1,
       n AS c2
FROM
  (SELECT Member,
          COUNT() AS n
   FROM
     (SELECT *
      FROM
        (SELECT Member,
                Element,
                Member.other,
                Element.other
         FROM
           (SELECT LHS.Member AS Member,
                   LHS.Element AS Element,
                   COALESCE(LHS.tmp.col, RHS.tmp.col) AS tmp.col,
                   RHS.Member AS Member.other,
                   RHS.Element AS Element.other
            FROM
              (SELECT Member,
                      Element,
                      1.0 AS tmp.col
               FROM input1) AS LHS
            FULL JOIN
              (SELECT Member,
                      Element,
                      1.0 AS tmp.col
               FROM input1
               WHERE (Member = 1.0)) AS RHS ON (LHS.tmp.col = RHS.tmp.col)))
      WHERE (Member != Member.other
             AND Element.other = Element))
   GROUP BY Member)
ORDER BY c1
