[     2.876][MainProcess][INFO] Parsing specification...
[     2.880][MainProcess][WARNING] "attrs" field is deprecated. Please use "columns"
[     2.880][MainProcess][WARNING] "aggrs" field is deprecated. Please use "functions"
[     2.880][MainProcess][WARNING] "const" field is deprecated. Please use "constants"
[     2.881][MainProcess][DEBUG] Reading input files...
[     2.890][MainProcess][INFO] Inferred data types for table tests-examples/textbook/tables/9-1.txt: ['string', 'string', 'string']
[     2.895][MainProcess][INFO] Inferred data types for table tests-examples/textbook/tables/9-2.txt: ['string', 'string']
[     2.899][MainProcess][INFO] Inferred data types for table tests-examples/textbook/tables/9.out: ['string', 'int64']
[     2.930][MainProcess][DEBUG] Generating DSL...
[     2.960][MainProcess][INFO] Creating 4 processes
[     3.008][cube-solver-0][DEBUG] Initialising process for 2 lines of code.
[     3.011][cube-solver-1][DEBUG] Initialising process for 2 lines of code.
[     3.024][cube-solver-2][DEBUG] Initialising process for 2 lines of code.
[     3.027][cube-solver-3][DEBUG] Initialising process for 2 lines of code.
[     3.479][cube-solver-1][WARNING] There is no solution for current loc (2).
[     3.479][cube-solver-1][DEBUG] Solving cube (l0 = filter(), l1 = summarise())
[     3.480][MainProcess][DEBUG] Increasing generator loc to 3
[     3.481][cube-solver-1][DEBUG] Initialising process for 3 lines of code.
[     3.491][cube-solver-0][WARNING] There is no solution for current loc (2).
[     3.492][cube-solver-0][DEBUG] Solving cube (l0 = summarise(), l1 = filter())
[     3.497][cube-solver-0][DEBUG] Initialising process for 3 lines of code.
[     3.515][cube-solver-2][WARNING] There is no solution for current loc (2).
[     3.516][cube-solver-2][DEBUG] Solving cube (l0 = filter(), l1 = mutate())
[     3.518][cube-solver-3][WARNING] There is no solution for current loc (2).
[     3.519][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter())
[     3.520][cube-solver-3][DEBUG] Initialising process for 3 lines of code.
[     3.521][cube-solver-2][DEBUG] Initialising process for 3 lines of code.
[     4.371][cube-solver-1][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise(), l2 = filter())
[     4.403][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = mutate(), l2 = filter())
[     4.421][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(), l1 = filter(), l2 = summarise())
[     4.456][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = filter(), l2 = mutate())
[     5.399][cube-solver-3][DEBUG] Solving cube (l0 = natural_join3(), l1 = summarise(), l2 = filter())
[     5.401][cube-solver-3][DEBUG] Solving cube (l0 = natural_join3(), l1 = filter(), l2 = summarise())
[     5.403][cube-solver-3][DEBUG] Solving cube (l0 = natural_join3(), l1 = filter(), l2 = mutate())
[     5.405][cube-solver-3][DEBUG] Solving cube (l0 = natural_join3(), l1 = mutate(), l2 = filter())
[     5.408][cube-solver-3][DEBUG] Solving cube (l0 = natural_join4(), l1 = summarise(), l2 = filter())
[     5.410][cube-solver-3][DEBUG] Solving cube (l0 = natural_join4(), l1 = filter(), l2 = summarise())
[     5.412][cube-solver-3][DEBUG] Solving cube (l0 = natural_join4(), l1 = filter(), l2 = mutate())
[     5.414][cube-solver-3][DEBUG] Solving cube (l0 = natural_join4(), l1 = mutate(), l2 = filter())
[     5.416][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join(), l2 = filter())
[     5.465][cube-solver-2][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join3(), l2 = filter())
[     5.946][cube-solver-1][DEBUG] Solving cube (l0 = summarise([4]), l1 = natural_join4(), l2 = filter())
[     5.955][cube-solver-1][DEBUG] Solving cube (l0 = summarise([4]), l1 = summarise([4]), l2 = filter())
[     5.963][cube-solver-1][DEBUG] Solving cube (l0 = summarise([4]), l1 = filter(), l2 = natural_join())
[     7.101][cube-solver-0][DEBUG] Solving cube (l0 = summarise([8]), l1 = filter([2]), l2 = natural_join3())
[     8.167][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = natural_join4())
[     8.178][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = summarise([11]))
[     8.189][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = filter([2]))
[     8.196][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = anti_join())
[     9.253][cube-solver-1][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = left_join())
[    11.761][cube-solver-1][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = union())
[    14.923][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = intersect())
[    16.645][cube-solver-1][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = semi_join())
[    17.648][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = cross_join())
[    17.863][cube-solver-1][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = mutate())
[    17.885][cube-solver-1][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = inner_join())
[    27.864][cube-solver-2][DEBUG] Solving cube (l0 = summarise([11]), l1 = anti_join(), l2 = filter([2]))
[    34.478][cube-solver-2][DEBUG] Solving cube (l0 = summarise([11]), l1 = left_join(), l2 = filter([2]))
[    36.800][cube-solver-2][DEBUG] Solving cube (l0 = summarise([11]), l1 = union(), l2 = filter([2]))
[    41.396][cube-solver-2][DEBUG] Solving cube (l0 = summarise([11]), l1 = intersect(), l2 = filter([2]))
[    43.694][cube-solver-0][DEBUG] Solving cube (l0 = summarise([11]), l1 = semi_join(), l2 = filter([2]))
[    43.858][cube-solver-2][DEBUG] Solving cube (l0 = summarise([11]), l1 = cross_join(), l2 = filter([2]))
[    44.473][cube-solver-0][DEBUG] Solving cube (l0 = summarise([11]), l1 = mutate(), l2 = filter([2]))
[    44.480][cube-solver-0][DEBUG] Solving cube (l0 = summarise([11]), l1 = inner_join(), l2 = filter([2]))
[   124.584][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join(), l2 = summarise([11]))
[   126.987][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join(), l2 = mutate())
[   127.902][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join3(), l2 = summarise([11]))
[   131.753][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join3(), l2 = mutate())
[   134.527][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join4(), l2 = summarise([11]))
[   134.550][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join4(), l2 = mutate())
[   134.559][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = natural_join())
[   135.279][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = natural_join3())
[   135.733][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = natural_join4())
[   135.741][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = summarise([11]))
[   135.751][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = filter([2]))
[   135.758][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = anti_join())
[   137.952][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = left_join())
[   141.195][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = union())
[   144.095][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = intersect())
[   147.158][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = semi_join())
[   147.465][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = cross_join())
[   148.665][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = mutate())
[   148.672][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = inner_join())
[   150.818][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = filter([2]), l2 = summarise([11]))
[   150.825][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = filter([2]), l2 = mutate())
[   150.829][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = anti_join(), l2 = summarise([11]))
[   156.959][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = anti_join(), l2 = mutate())
[   158.216][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = left_join(), l2 = summarise([11]))
[   160.659][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = left_join(), l2 = mutate())
[   161.583][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = union(), l2 = summarise([11]))
[   163.988][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = union(), l2 = mutate())
[   164.914][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = intersect(), l2 = summarise([11]))
[   167.741][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = intersect(), l2 = mutate())
[   168.015][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = semi_join(), l2 = summarise([11]))
[   169.214][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = semi_join(), l2 = mutate())
[   169.654][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = cross_join(), l2 = summarise([11]))
[   189.276][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = cross_join(), l2 = mutate())
[   198.223][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = natural_join())
[   200.009][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = natural_join3())
[   213.524][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = natural_join4())
[   245.912][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = summarise([11]))
[   245.918][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = filter([2]))
[   245.922][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = anti_join())
[   248.009][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = left_join())
[   249.796][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = union())
[   251.576][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = intersect())
[   252.132][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = semi_join())
[   252.774][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = cross_join())
[   264.110][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = mutate())
[   264.113][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = inner_join())
[   272.622][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = inner_join(), l2 = summarise([11]))
[   278.909][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = inner_join(), l2 = mutate())
[   288.725][cube-solver-2][DEBUG] Solving cube (l0 = anti_join(), l1 = summarise([11]), l2 = filter([2]))
[   294.588][cube-solver-2][DEBUG] Solving cube (l0 = anti_join([18]), l1 = filter([2]), l2 = summarise([11]))
[   297.053][cube-solver-2][DEBUG] Solving cube (l0 = anti_join([18]), l1 = filter([2]), l2 = mutate())
[   297.999][cube-solver-2][DEBUG] Solving cube (l0 = anti_join([18]), l1 = mutate(), l2 = filter([2]))
[   298.942][cube-solver-2][DEBUG] Solving cube (l0 = left_join(), l1 = summarise([11]), l2 = filter([2]))
[   300.338][cube-solver-2][DEBUG] Solving cube (l0 = left_join(), l1 = filter([2]), l2 = summarise([11]))
[   302.794][cube-solver-2][DEBUG] Solving cube (l0 = left_join(), l1 = filter([2]), l2 = mutate())
[   303.734][cube-solver-2][DEBUG] Solving cube (l0 = left_join(), l1 = mutate(), l2 = filter([2]))
[   304.086][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = summarise([11]), l2 = filter([2]))
[   304.723][cube-solver-2][DEBUG] Solving cube (l0 = union(), l1 = filter([2]), l2 = summarise([11]))
[   305.442][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = filter([2]), l2 = mutate())
[   306.396][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = mutate(), l2 = filter([2]))
[   307.186][cube-solver-2][DEBUG] Solving cube (l0 = intersect(), l1 = summarise([11]), l2 = filter([2]))
[   307.376][cube-solver-1][DEBUG] Solving cube (l0 = intersect([1]), l1 = filter([2]), l2 = summarise([11]))
[   309.730][cube-solver-2][DEBUG] Solving cube (l0 = intersect([8]), l1 = filter([2]), l2 = mutate())
[   309.733][cube-solver-1][DEBUG] Solving cube (l0 = intersect([8]), l1 = mutate(), l2 = filter([2]))
[   309.739][cube-solver-1][DEBUG] Solving cube (l0 = semi_join(), l1 = summarise([11]), l2 = filter([2]))
[   309.744][cube-solver-2][DEBUG] Solving cube (l0 = semi_join(), l1 = filter([2]), l2 = summarise([11]))
[   310.476][cube-solver-1][DEBUG] Solving cube (l0 = semi_join(), l1 = filter([2]), l2 = mutate())
[   310.755][cube-solver-2][DEBUG] Solving cube (l0 = semi_join(), l1 = mutate(), l2 = filter([2]))
[   310.809][cube-solver-1][DEBUG] Solving cube (l0 = cross_join(), l1 = summarise([11]), l2 = filter([2]))
[   311.066][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([6]), l1 = filter([2]), l2 = summarise([11]))
[   315.008][cube-solver-0][DEBUG] Solving cube (l0 = cross_join([123]), l1 = filter([2]), l2 = mutate())
[   320.898][cube-solver-0][DEBUG] Solving cube (l0 = cross_join([386]), l1 = mutate(), l2 = filter([2]))
[   321.056][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join(), l2 = filter([2]))
[   323.075][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join3(), l2 = filter([2]))
[   328.651][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join4(), l2 = filter([2]))
[   328.664][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = summarise([11]), l2 = filter([2]))
[   328.674][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = natural_join())
[   330.580][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = natural_join3())
[   344.950][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = natural_join4())
[   364.372][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = summarise([11]))
[   364.680][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = filter([2]))
[   364.822][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = anti_join([18]))
[   367.574][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = left_join())
[   369.578][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = union())
[   371.617][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = intersect([8]))
[   372.378][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = semi_join())
[   373.152][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = cross_join([386]))
[   379.099][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = mutate())
[   379.111][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = inner_join())
[   395.823][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = anti_join([18]), l2 = filter([2]))
[   397.367][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = left_join(), l2 = filter([2]))
[   398.178][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = union(), l2 = filter([2]))
[   399.307][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = intersect([8]), l2 = filter([2]))
[   399.953][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = semi_join(), l2 = filter([2]))
[   400.318][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = cross_join([386]), l2 = filter([2]))
[   400.432][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = mutate(), l2 = filter([2]))
[   400.435][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = inner_join(), l2 = filter([2]))
[   401.024][cube-solver-3][DEBUG] Solving cube (l0 = inner_join(), l1 = summarise([11]), l2 = filter([2]))
[   419.630][cube-solver-2][DEBUG] Solving cube (l0 = inner_join([38]), l1 = filter([2]), l2 = summarise([11]))
[   435.146][cube-solver-0][DEBUG] Solving cube (l0 = inner_join([198]), l1 = filter([2]), l2 = mutate())
[   450.892][cube-solver-1][DEBUG] Solving cube (l0 = inner_join([221]), l1 = mutate(), l2 = filter([2]))
[   455.694][MainProcess][DEBUG] Increasing generator loc to 4
[   455.695][cube-solver-0][DEBUG] Initialising process for 4 lines of code.
[   457.018][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = natural_join(), l3 = filter([2]))
[   471.577][cube-solver-1][DEBUG] Initialising process for 4 lines of code.
[   472.992][cube-solver-1][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = natural_join3(), l3 = filter([2]))
[   485.422][cube-solver-3][DEBUG] Initialising process for 4 lines of code.
[   486.717][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = natural_join4(), l3 = filter([2]))
[   486.731][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = summarise([11]), l3 = filter([2]))
[   486.742][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = natural_join())
[   501.713][cube-solver-2][DEBUG] Initialising process for 4 lines of code.
[   503.084][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = natural_join3())
[   509.264][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = natural_join4())
[   509.273][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = summarise([11]))
[   516.640][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = filter([2]))
[   519.600][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = anti_join([18]))
[   523.231][cube-solver-1][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = left_join())
[   537.597][cube-solver-0][DEBUG] Found solution with cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = anti_join([18]))
[   537.599][MainProcess][INFO] Statistics:
[   537.600][MainProcess][INFO] 	Generated cubes: 153
[   537.600][MainProcess][INFO] 	Attempted programs: 105347
[   537.601][MainProcess][INFO] 		Rejected: 6613
[   537.601][MainProcess][INFO] 		Failed: 98733
[   537.601][MainProcess][INFO] 	Blacklist clauses: 646
[   537.601][MainProcess][DEBUG] Printing statistics for good programs of size 3
[   537.657][MainProcess][DEBUG] 	0: Counter({'filter': 49984, 'summarise': 29368, 'mutate': 25264, 'inner_join': 17664, 'natural_join': 832, 'anti_join': 832, 'left_join': 832, 'union': 832, 'semi_join': 248})
[   537.693][MainProcess][DEBUG] 	1: Counter({'filter': 42528, 'summarise': 26864, 'inner_join': 24696, 'mutate': 20328, 'natural_join3': 6176, 'union': 1600, 'natural_join': 1184, 'left_join': 1184, 'anti_join': 944, 'semi_join': 352})
[   537.727][MainProcess][DEBUG] 	2: Counter({'filter': 33344, 'inner_join': 30224, 'natural_join3': 19904, 'summarise': 15368, 'natural_join4': 11520, 'mutate': 8664, 'union': 2416, 'natural_join': 1488, 'left_join': 1488, 'anti_join': 960, 'semi_join': 480})
[   537.727][MainProcess][DEBUG] Printing statistics for good programs of size 4
[   537.736][MainProcess][DEBUG] 	0: Counter({'natural_join': 34029})
[   537.744][MainProcess][DEBUG] 	1: Counter({'summarise': 34030})
[   537.751][MainProcess][DEBUG] 	2: Counter({'filter': 17134, 'natural_join': 8576, 'natural_join3': 8320})
[   537.758][MainProcess][DEBUG] 	3: Counter({'filter': 17216, 'natural_join': 7713, 'natural_join3': 5329, 'left_join': 2272, 'anti_join': 1245, 'summarise': 256})
[   537.758][MainProcess][INFO] Solution found: anti_join(summarise(natural_join(@param1, @param0), n = n(), F_name), filter(natural_join(@param1, @param0), Room != 'R128'), )

------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/textbook/tables/9-1.txt", col_types = cols(ID_class = col_character(),ID_key = col_character(),Room = col_character()))
input1 <- copy_to(con, input1)
input2 <- read_csv("tests-examples/textbook/tables/9-2.txt", col_types = cols(ID_key = col_character(),F_name = col_character()))
input2 <- copy_to(con, input2)
expected_output <- read_csv("tests-examples/textbook/tables/9.out", col_types = cols(F_name = col_character(),n = col_integer()))

df3 <- inner_join(input2, input1)
df4 <- df3 %>% group_by(F_name) %>% summarise(n = n()) %>% ungroup()
df5 <- df3 %>% filter(Room != 'R128')
df6 <- anti_join(df4, df5, by=c())
out <- df6 %>% select(F_name, n) %>% arrange(F_name)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `F_name`,
       `n`
FROM
  (SELECT *
   FROM
     (SELECT `F_name`,
             COUNT() AS `n`
      FROM
        (SELECT `LHS`.`ID_key` AS `ID_key`,
                `LHS`.`F_name` AS `F_name`,
                `RHS`.`ID_class` AS `ID_class`,
                `RHS`.`Room` AS `Room`
         FROM `input2` AS `LHS`
         INNER JOIN `input1` AS `RHS` ON (`LHS`.`ID_key` = `RHS`.`ID_key`))
      GROUP BY `F_name`) AS `LHS`
   WHERE NOT EXISTS
       (SELECT 1
        FROM
          (SELECT *
           FROM
             (SELECT `LHS`.`ID_key` AS `ID_key`,
                     `LHS`.`F_name` AS `F_name`,
                     `RHS`.`ID_class` AS `ID_class`,
                     `RHS`.`Room` AS `Room`
              FROM `input2` AS `LHS`
              INNER JOIN `input1` AS `RHS` ON (`LHS`.`ID_key` = `RHS`.`ID_key`))
           WHERE (`Room` != 'R128')) AS RHS
        WHERE (LHS.F_name = RHS.F_name) ))
ORDER BY F_name
