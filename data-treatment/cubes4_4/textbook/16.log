[     3.771][MainProcess][INFO] Parsing specification...
[     3.776][MainProcess][WARNING] "attrs" field is deprecated. Please use "columns"
[     3.776][MainProcess][WARNING] "aggrs" field is deprecated. Please use "functions"
[     3.776][MainProcess][WARNING] "const" field is deprecated. Please use "constants"
[     3.777][MainProcess][DEBUG] Reading input files...
[     3.786][MainProcess][INFO] Inferred data types for table tests-examples/textbook/tables/16-1.txt: ['string', 'string']
[     3.792][MainProcess][INFO] Inferred data types for table tests-examples/textbook/tables/16-2.txt: ['string', 'string']
[     3.798][MainProcess][INFO] Inferred data types for table tests-examples/textbook/tables/16-3.txt: ['string', 'string']
[     3.803][MainProcess][INFO] Inferred data types for table tests-examples/textbook/tables/16.out: ['string']
[     3.848][MainProcess][DEBUG] Generating DSL...
[     3.890][MainProcess][INFO] Creating 4 processes
[     3.953][cube-solver-0][DEBUG] Initialising process for 2 lines of code.
[     3.964][cube-solver-1][DEBUG] Initialising process for 2 lines of code.
[     3.965][cube-solver-2][DEBUG] Initialising process for 2 lines of code.
[     3.970][cube-solver-3][DEBUG] Initialising process for 2 lines of code.
[     4.444][cube-solver-0][WARNING] There is no solution for current loc (2).
[     4.445][cube-solver-0][DEBUG] Solving cube (l0 = summarise(), l1 = filter())
[     4.446][MainProcess][DEBUG] Increasing generator loc to 3
[     4.447][cube-solver-0][DEBUG] Initialising process for 3 lines of code.
[     4.454][cube-solver-2][WARNING] There is no solution for current loc (2).
[     4.455][cube-solver-2][DEBUG] Solving cube (l0 = filter(), l1 = mutate())
[     4.460][cube-solver-2][DEBUG] Initialising process for 3 lines of code.
[     4.468][cube-solver-3][WARNING] There is no solution for current loc (2).
[     4.469][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter())
[     4.471][cube-solver-3][DEBUG] Initialising process for 3 lines of code.
[     4.504][cube-solver-1][WARNING] There is no solution for current loc (2).
[     4.505][cube-solver-1][DEBUG] Solving cube (l0 = filter(), l1 = summarise())
[     4.510][cube-solver-1][DEBUG] Initialising process for 3 lines of code.
[     5.347][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise(), l2 = filter())
[     5.353][cube-solver-0][DEBUG] Solving cube (l0 = natural_join3(), l1 = summarise(), l2 = filter())
[     5.369][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = filter(), l2 = mutate())
[     5.380][cube-solver-3][DEBUG] Solving cube (l0 = natural_join3([1]), l1 = filter(), l2 = summarise())
[     5.392][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = filter(), l2 = summarise())
[     5.397][cube-solver-2][DEBUG] Solving cube (l0 = natural_join3([1]), l1 = filter(), l2 = mutate())
[     5.458][cube-solver-1][DEBUG] Solving cube (l0 = natural_join(), l1 = mutate(), l2 = filter())
[     5.463][cube-solver-1][DEBUG] Solving cube (l0 = natural_join3([2]), l1 = mutate(), l2 = filter())
[     5.984][cube-solver-2][DEBUG] Solving cube (l0 = natural_join4(), l1 = summarise(), l2 = filter())
[     5.987][cube-solver-2][DEBUG] Solving cube (l0 = natural_join4(), l1 = filter(), l2 = summarise())
[     5.989][cube-solver-2][DEBUG] Solving cube (l0 = natural_join4(), l1 = filter(), l2 = mutate())
[     5.991][cube-solver-2][DEBUG] Solving cube (l0 = natural_join4(), l1 = mutate(), l2 = filter())
[     5.994][cube-solver-2][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join(), l2 = filter())
[     5.996][cube-solver-2][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join3([2]), l2 = filter())
[     6.056][cube-solver-1][DEBUG] Solving cube (l0 = summarise([3]), l1 = natural_join4(), l2 = filter())
[     6.060][cube-solver-1][DEBUG] Solving cube (l0 = summarise([4]), l1 = summarise([4]), l2 = filter())
[     6.065][cube-solver-1][DEBUG] Solving cube (l0 = summarise([4]), l1 = filter(), l2 = natural_join())
[     6.069][cube-solver-1][DEBUG] Solving cube (l0 = summarise([4]), l1 = filter(), l2 = natural_join3([2]))
[     7.809][cube-solver-0][DEBUG] Solving cube (l0 = summarise([16]), l1 = filter([4]), l2 = natural_join4())
[     9.020][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = filter([4]), l2 = summarise([21]))
[     9.044][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = filter([4]), l2 = filter([4]))
[     9.064][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = filter([4]), l2 = anti_join())
[     9.077][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = filter([4]), l2 = left_join())
[     9.089][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = filter([4]), l2 = union())
[     9.101][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = filter([4]), l2 = intersect())
[     9.113][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = filter([4]), l2 = semi_join())
[     9.125][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = filter([4]), l2 = cross_join())
[     9.138][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = filter([4]), l2 = mutate())
[     9.149][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = filter([4]), l2 = inner_join())
[     9.163][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = anti_join(), l2 = filter([4]))
[     9.177][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = left_join(), l2 = filter([4]))
[     9.188][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = union(), l2 = filter([4]))
[     9.201][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = intersect(), l2 = filter([4]))
[     9.223][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = semi_join(), l2 = filter([4]))
[     9.242][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = cross_join(), l2 = filter([4]))
[     9.254][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = mutate(), l2 = filter([4]))
[     9.266][cube-solver-3][DEBUG] Solving cube (l0 = summarise([21]), l1 = inner_join(), l2 = filter([4]))
[     9.278][cube-solver-3][DEBUG] Solving cube (l0 = filter([4]), l1 = natural_join(), l2 = summarise([21]))
[     9.289][cube-solver-3][DEBUG] Solving cube (l0 = filter([4]), l1 = natural_join(), l2 = mutate())
[     9.294][cube-solver-3][DEBUG] Solving cube (l0 = filter([4]), l1 = natural_join3([2]), l2 = summarise([21]))
[    11.048][cube-solver-2][DEBUG] Solving cube (l0 = filter([4]), l1 = natural_join3([2]), l2 = mutate())
[    11.605][cube-solver-2][DEBUG] Solving cube (l0 = filter([4]), l1 = natural_join4(), l2 = summarise([21]))
[    12.907][cube-solver-3][DEBUG] Solving cube (l0 = filter([4]), l1 = natural_join4(), l2 = mutate())
[    14.914][cube-solver-3][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = natural_join())
[    14.933][cube-solver-3][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = natural_join3([2]))
[    16.202][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = natural_join4())
[    16.219][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = summarise([21]))
[    16.237][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = filter([4]))
[    16.248][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = anti_join())
[    16.260][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = left_join())
[    16.270][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = union())
[    16.280][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = intersect())
[    16.290][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = semi_join())
[    16.301][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = cross_join())
[    16.312][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = mutate())
[    16.322][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = summarise([21]), l2 = inner_join())
[    16.333][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = filter([4]), l2 = summarise([21]))
[    16.344][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = filter([4]), l2 = mutate())
[    16.349][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = anti_join(), l2 = summarise([21]))
[    16.359][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = anti_join(), l2 = mutate())
[    16.363][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = left_join(), l2 = summarise([21]))
[    16.373][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = left_join(), l2 = mutate())
[    16.377][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = union(), l2 = summarise([21]))
[    16.386][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = union(), l2 = mutate())
[    16.390][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = intersect(), l2 = summarise([21]))
[    16.400][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = intersect(), l2 = mutate())
[    16.404][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = semi_join(), l2 = summarise([21]))
[    16.414][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = semi_join(), l2 = mutate())
[    16.417][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = cross_join(), l2 = summarise([21]))
[    16.428][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = cross_join(), l2 = mutate())
[    16.431][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = natural_join())
[    16.435][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = natural_join3([2]))
[    16.550][cube-solver-0][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = natural_join4())
[    18.128][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = summarise([21]))
[    18.138][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = filter([4]))
[    18.143][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = anti_join())
[    18.146][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = left_join())
[    18.150][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = union())
[    18.153][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = intersect())
[    18.156][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = semi_join())
[    18.159][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = cross_join())
[    18.162][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = mutate())
[    18.166][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = mutate(), l2 = inner_join())
[    18.169][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = inner_join(), l2 = summarise([21]))
[    18.180][cube-solver-1][DEBUG] Solving cube (l0 = filter([4]), l1 = inner_join(), l2 = mutate())
[    18.184][cube-solver-1][DEBUG] Solving cube (l0 = anti_join(), l1 = summarise([21]), l2 = filter([4]))
[    18.195][cube-solver-1][DEBUG] Solving cube (l0 = anti_join(), l1 = filter([4]), l2 = summarise([21]))
[    18.205][cube-solver-1][DEBUG] Solving cube (l0 = anti_join(), l1 = filter([4]), l2 = mutate())
[    18.209][cube-solver-1][DEBUG] Solving cube (l0 = anti_join(), l1 = mutate(), l2 = filter([4]))
[    18.213][cube-solver-1][DEBUG] Solving cube (l0 = left_join(), l1 = summarise([21]), l2 = filter([4]))
[    18.224][cube-solver-1][DEBUG] Solving cube (l0 = left_join(), l1 = filter([4]), l2 = summarise([21]))
[    18.235][cube-solver-1][DEBUG] Solving cube (l0 = left_join(), l1 = filter([4]), l2 = mutate())
[    18.239][cube-solver-1][DEBUG] Solving cube (l0 = left_join(), l1 = mutate(), l2 = filter([4]))
[    18.243][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = summarise([21]), l2 = filter([4]))
[    18.254][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = filter([4]), l2 = summarise([21]))
[    18.264][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = filter([4]), l2 = mutate())
[    18.268][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = mutate(), l2 = filter([4]))
[    18.272][cube-solver-1][DEBUG] Solving cube (l0 = intersect(), l1 = summarise([21]), l2 = filter([4]))
[    18.282][cube-solver-1][DEBUG] Solving cube (l0 = intersect(), l1 = filter([4]), l2 = summarise([21]))
[    18.292][cube-solver-1][DEBUG] Solving cube (l0 = intersect(), l1 = filter([4]), l2 = mutate())
[    18.296][cube-solver-1][DEBUG] Solving cube (l0 = intersect(), l1 = mutate(), l2 = filter([4]))
[    18.300][cube-solver-1][DEBUG] Solving cube (l0 = semi_join(), l1 = summarise([21]), l2 = filter([4]))
[    18.310][cube-solver-1][DEBUG] Solving cube (l0 = semi_join(), l1 = filter([4]), l2 = summarise([21]))
[    18.320][cube-solver-1][DEBUG] Solving cube (l0 = semi_join(), l1 = filter([4]), l2 = mutate())
[    18.324][cube-solver-1][DEBUG] Solving cube (l0 = semi_join(), l1 = mutate(), l2 = filter([4]))
[    18.328][cube-solver-1][DEBUG] Solving cube (l0 = cross_join(), l1 = summarise([21]), l2 = filter([4]))
[    18.339][cube-solver-1][DEBUG] Solving cube (l0 = cross_join(), l1 = filter([4]), l2 = summarise([21]))
[    18.349][cube-solver-1][DEBUG] Solving cube (l0 = cross_join(), l1 = filter([4]), l2 = mutate())
[    18.353][cube-solver-1][DEBUG] Solving cube (l0 = cross_join(), l1 = mutate(), l2 = filter([4]))
[    18.356][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join(), l2 = filter([4]))
[    18.359][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join3([2]), l2 = filter([4]))
[    19.072][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join4(), l2 = filter([4]))
[    20.072][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = summarise([21]), l2 = filter([4]))
[    20.083][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = natural_join())
[    20.086][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = natural_join3([2]))
[    22.001][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = natural_join4())
[    25.010][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = summarise([21]))
[    25.021][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = filter([4]))
[    25.025][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = anti_join())
[    25.030][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = left_join())
[    25.033][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = union())
[    25.036][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = intersect())
[    25.039][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = semi_join())
[    25.042][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = cross_join())
[    25.046][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = mutate())
[    25.049][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([4]), l2 = inner_join())
[    25.052][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = anti_join(), l2 = filter([4]))
[    25.056][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = left_join(), l2 = filter([4]))
[    25.059][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = union(), l2 = filter([4]))
[    25.062][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = intersect(), l2 = filter([4]))
[    25.065][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = semi_join(), l2 = filter([4]))
[    25.069][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = cross_join(), l2 = filter([4]))
[    25.072][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = mutate(), l2 = filter([4]))
[    25.075][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = inner_join(), l2 = filter([4]))
[    25.080][cube-solver-2][DEBUG] Solving cube (l0 = inner_join(), l1 = summarise([21]), l2 = filter([4]))
[    25.090][cube-solver-2][DEBUG] Solving cube (l0 = inner_join(), l1 = filter([4]), l2 = summarise([21]))
[    25.100][cube-solver-2][DEBUG] Solving cube (l0 = inner_join(), l1 = filter([4]), l2 = mutate())
[    25.104][cube-solver-2][DEBUG] Solving cube (l0 = inner_join(), l1 = mutate(), l2 = filter([4]))
[    25.107][MainProcess][DEBUG] Increasing generator loc to 4
[    25.108][cube-solver-2][DEBUG] Initialising process for 4 lines of code.
[    25.538][cube-solver-3][DEBUG] Initialising process for 4 lines of code.
[    26.385][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([21]), l2 = natural_join(), l3 = filter([4]))
[    26.841][cube-solver-3][DEBUG] Solving cube (l0 = natural_join([2]), l1 = summarise([21]), l2 = natural_join3([2]), l3 = filter([4]))
[    31.135][cube-solver-0][DEBUG] Initialising process for 4 lines of code.
[    32.459][cube-solver-0][DEBUG] Solving cube (l0 = natural_join([2]), l1 = summarise([21]), l2 = natural_join4(), l3 = filter([4]))
[    32.480][cube-solver-0][DEBUG] Solving cube (l0 = natural_join([2]), l1 = summarise([21]), l2 = summarise([21]), l3 = filter([4]))
[    32.501][cube-solver-0][DEBUG] Solving cube (l0 = natural_join([2]), l1 = summarise([21]), l2 = filter([4]), l3 = natural_join([2]))
[    32.908][cube-solver-2][DEBUG] Solving cube (l0 = natural_join([2]), l1 = summarise([21]), l2 = filter([4]), l3 = natural_join3([2]))
[    38.868][cube-solver-1][DEBUG] Initialising process for 4 lines of code.
[    39.408][cube-solver-0][DEBUG] Solving cube (l0 = natural_join([2]), l1 = summarise([21]), l2 = filter([4]), l3 = summarise([21]))
[    39.427][cube-solver-0][DEBUG] Solving cube (l0 = natural_join([2]), l1 = summarise([21]), l2 = filter([4]), l3 = filter([4]))
[    39.440][cube-solver-0][DEBUG] Solving cube (l0 = natural_join([2]), l1 = summarise([21]), l2 = filter([4]), l3 = anti_join())
[    40.152][cube-solver-1][DEBUG] Solving cube (l0 = natural_join([2]), l1 = summarise([21]), l2 = filter([4]), l3 = natural_join4())
[    43.755][cube-solver-0][DEBUG] Found solution with cube (l0 = natural_join([2]), l1 = summarise([21]), l2 = filter([4]), l3 = anti_join())
[    43.756][MainProcess][INFO] Statistics:
[    43.757][MainProcess][INFO] 	Generated cubes: 152
[    43.757][MainProcess][INFO] 	Attempted programs: 5147
[    43.757][MainProcess][INFO] 		Rejected: 1373
[    43.758][MainProcess][INFO] 		Failed: 3773
[    43.758][MainProcess][INFO] 	Blacklist clauses: 29
[    43.758][MainProcess][DEBUG] Printing statistics for good programs of size 3
[    43.767][MainProcess][DEBUG] 	0: Counter({'filter': 4920, 'mutate': 3520, 'summarise': 1048, 'natural_join3': 752})
[    43.771][MainProcess][DEBUG] 	1: Counter({'filter': 3560, 'natural_join4': 2696, 'mutate': 2400, 'natural_join3': 1040, 'summarise': 544})
[    43.774][MainProcess][DEBUG] 	2: Counter({'natural_join4': 4600, 'summarise': 2288, 'filter': 1760, 'natural_join3': 1152, 'mutate': 440})
[    43.775][MainProcess][DEBUG] Printing statistics for good programs of size 4
[    43.776][MainProcess][DEBUG] 	0: Counter({'natural_join': 3621})
[    43.777][MainProcess][DEBUG] 	1: Counter({'summarise': 3621})
[    43.778][MainProcess][DEBUG] 	2: Counter({'filter': 1765, 'natural_join3': 1392, 'natural_join': 464})
[    43.779][MainProcess][DEBUG] 	3: Counter({'filter': 1856, 'natural_join3': 1128, 'natural_join': 464, 'natural_join4': 150, 'anti_join': 23})
[    43.779][MainProcess][INFO] Solution found: anti_join(summarise(@param1, n = n(), P_id, P_name), filter(natural_join(@param0, @param2), S_name != 'AWS'), 'P_id')

------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/textbook/tables/16-1.txt", col_types = cols(S_key = col_character(),P_id = col_character()))
input1 <- copy_to(con, input1)
input2 <- read_csv("tests-examples/textbook/tables/16-2.txt", col_types = cols(P_id = col_character(),P_name = col_character()))
input2 <- copy_to(con, input2)
input3 <- read_csv("tests-examples/textbook/tables/16-3.txt", col_types = cols(S_key = col_character(),S_name = col_character()))
input3 <- copy_to(con, input3)
expected_output <- read_csv("tests-examples/textbook/tables/16.out", col_types = cols(P_name = col_character()))

df4 <- input2 %>% group_by(P_id, P_name) %>% summarise(n = n()) %>% ungroup()
df5 <- inner_join(input1, input3)
df6 <- df5 %>% filter(S_name != 'AWS')
df7 <- anti_join(df4, df6, by=c('P_id'))
out <- df7 %>% select(P_name) %>% arrange(P_name)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `P_name`
FROM
  (SELECT *
   FROM
     (SELECT `P_id`,
             `P_name`,
             COUNT() AS `n`
      FROM `input2`
      GROUP BY `P_id`,
               `P_name`) AS `LHS`
   WHERE NOT EXISTS
       (SELECT 1
        FROM
          (SELECT *
           FROM
             (SELECT `LHS`.`S_key` AS `S_key`,
                     `LHS`.`P_id` AS `P_id`,
                     `RHS`.`S_name` AS `S_name`
              FROM `input1` AS `LHS`
              INNER JOIN `input3` AS `RHS` ON (`LHS`.`S_key` = `RHS`.`S_key`))
           WHERE (`S_name` != 'AWS')) AS RHS
        WHERE (LHS.P_id = RHS.P_id) ))
ORDER BY P_name
