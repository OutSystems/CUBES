[     3.389][MainProcess][INFO] Parsing specification...
[     3.395][MainProcess][WARNING] "attrs" field is deprecated. Please use "columns"
[     3.395][MainProcess][WARNING] "aggrs" field is deprecated. Please use "functions"
[     3.395][MainProcess][DEBUG] Reading input files...
[     3.407][MainProcess][INFO] Inferred data types for table tests-examples/scythe/recent_posts/tables/034.csv: ['string', 'datetime64[ns]', 'datetime64[ns]']
[     3.415][MainProcess][INFO] Inferred data types for table tests-examples/scythe/recent_posts/tables/034_o.csv: ['string', 'datetime64[ns]', 'datetime64[ns]']
[     3.457][MainProcess][DEBUG] Generating DSL...
[     3.638][MainProcess][INFO] Creating 4 processes
[     3.655][MainProcess][DEBUG] Increasing generator loc to 2
[     3.818][cube-solver-0][DEBUG] Initialising process for 1 lines of code.
[     3.851][cube-solver-1][DEBUG] Initialising process for 1 lines of code.
[     3.855][cube-solver-2][DEBUG] Initialising process for 2 lines of code.
[     3.860][cube-solver-3][DEBUG] Initialising process for 2 lines of code.
[     6.423][cube-solver-1][DEBUG] Solving cube (l0 = mutate(),)
[     6.467][cube-solver-0][DEBUG] Solving cube (l0 = summarise(),)
[     6.756][cube-solver-1][DEBUG] Initialising process for 2 lines of code.
[     6.775][cube-solver-0][DEBUG] Initialising process for 2 lines of code.
[     9.034][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise())
[     9.050][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = mutate())
[     9.076][cube-solver-2][DEBUG] Solving cube (l0 = natural_join4(), l1 = summarise())
[     9.083][cube-solver-3][DEBUG] Solving cube (l0 = natural_join4(), l1 = mutate())
[     9.094][cube-solver-2][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join())
[     9.095][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join3())
[     9.112][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join4())
[     9.124][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = summarise())
[     9.137][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = filter())
[    10.240][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = anti_join())
[    11.851][cube-solver-1][DEBUG] Solving cube (l0 = natural_join3(), l1 = summarise())
[    11.876][cube-solver-0][DEBUG] Solving cube (l0 = natural_join3(), l1 = mutate())
[    11.878][cube-solver-1][DEBUG] Solving cube (l0 = summarise(), l1 = left_join())
[    11.904][cube-solver-0][DEBUG] Solving cube (l0 = summarise(), l1 = union())
[    12.755][cube-solver-2][DEBUG] Solving cube (l0 = summarise(), l1 = intersect())
[    13.468][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = semi_join())
[    13.834][cube-solver-2][DEBUG] Solving cube (l0 = summarise(), l1 = cross_join())
[    14.568][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = mutate())
[    14.789][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = inner_join())
[    15.605][cube-solver-0][DEBUG] Solving cube (l0 = filter(), l1 = summarise())
[    15.618][cube-solver-0][DEBUG] Solving cube (l0 = filter(), l1 = mutate())
[    15.630][cube-solver-0][DEBUG] Solving cube (l0 = anti_join(), l1 = summarise())
[    15.645][cube-solver-0][DEBUG] Solving cube (l0 = left_join(), l1 = summarise())
[    15.647][cube-solver-1][DEBUG] Solving cube (l0 = anti_join(), l1 = mutate())
[    15.660][cube-solver-1][DEBUG] Solving cube (l0 = left_join(), l1 = mutate())
[    15.944][cube-solver-0][DEBUG] Solving cube (l0 = union(), l1 = summarise())
[    15.963][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = mutate())
[    16.234][cube-solver-0][DEBUG] Solving cube (l0 = intersect(), l1 = summarise())
[    16.260][cube-solver-1][DEBUG] Solving cube (l0 = intersect(), l1 = mutate())
[    16.325][cube-solver-1][DEBUG] Solving cube (l0 = semi_join(), l1 = summarise())
[    16.529][cube-solver-0][DEBUG] Solving cube (l0 = semi_join(), l1 = mutate())
[    16.623][cube-solver-1][DEBUG] Solving cube (l0 = cross_join(), l1 = summarise())
[    16.840][cube-solver-0][DEBUG] Solving cube (l0 = cross_join([5]), l1 = mutate())
[    37.423][cube-solver-3][DEBUG] Found solution with cube (l0 = summarise(), l1 = inner_join())
[    37.426][MainProcess][INFO] Statistics:
[    37.426][MainProcess][INFO] 	Generated cubes: 35
[    37.427][MainProcess][INFO] 	Attempted programs: 437
[    37.427][MainProcess][INFO] 		Rejected: 218
[    37.427][MainProcess][INFO] 		Failed: 218
[    37.427][MainProcess][INFO] 	Blacklist clauses: 5
[    37.427][MainProcess][DEBUG] Printing statistics for good programs of size 1
[    37.428][MainProcess][DEBUG] 	0: Counter({'mutate': 48, 'summarise': 36})
[    37.428][MainProcess][DEBUG] Printing statistics for good programs of size 2
[    37.437][MainProcess][DEBUG] 	0: Counter({'summarise': 9970, 'cross_join': 2341, 'left_join': 84, 'union': 84, 'semi_join': 84})
[    37.440][MainProcess][DEBUG] 	1: Counter({'cross_join': 3925, 'inner_join': 3597, 'mutate': 2413, 'left_join': 612, 'union': 612, 'natural_join': 576, 'anti_join': 360, 'summarise': 204, 'semi_join': 144, 'filter': 120})
[    37.440][MainProcess][INFO] Solution found: inner_join(summarise(@param0, maxDATE_UPDATE = max(DATE_UPDATE), MATERIAL), @param0, 'maxDATE_UPDATE' = 'DATE_UPDATE')

------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/scythe/recent_posts/tables/034.csv", col_types = cols(MATERIAL = col_character(),DISCO_DATE = col_character(),DATE_UPDATE = col_character()))
input1$DISCO_DATE <- ymd(input1$DISCO_DATE)
input1$DATE_UPDATE <- ymd(input1$DATE_UPDATE)
input1 <- copy_to(con, input1)
expected_output <- read_csv("tests-examples/scythe/recent_posts/tables/034_o.csv", col_types = cols(c1 = col_character(),c2 = col_character(),c3 = col_character()))
expected_output$c2 <- ymd(expected_output$c2)
expected_output$c3 <- ymd(expected_output$c3)

df2 <- input1 %>% group_by(MATERIAL) %>% summarise(maxDATE_UPDATE = max(DATE_UPDATE)) %>% ungroup()
df3 <- inner_join(df2, input1, by=c('maxDATE_UPDATE' = 'DATE_UPDATE'), suffix = c('', '.other'))
out <- df3 %>% select(c1 = MATERIAL, c2 = DISCO_DATE, c3 = maxDATE_UPDATE) %>% arrange(c1)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT MATERIAL AS c1,
       DISCO_DATE AS c2,
       maxDATE_UPDATE AS c3
FROM
  (SELECT LHS.MATERIAL AS MATERIAL,
          LHS.maxDATE_UPDATE AS maxDATE_UPDATE,
          RHS.MATERIAL AS MATERIAL.other,
          RHS.DISCO_DATE AS DISCO_DATE
   FROM
     (SELECT MATERIAL,
             MAX(DATE_UPDATE) AS maxDATE_UPDATE
      FROM input1
      GROUP BY MATERIAL) AS LHS
   INNER JOIN input1 AS RHS ON (LHS.maxDATE_UPDATE = RHS.DATE_UPDATE))
ORDER BY c1
