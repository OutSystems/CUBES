[     1.595][MainProcess][INFO] Parsing specification...
[     1.599][MainProcess][DEBUG] Reading input files...
[     1.607][MainProcess][INFO] Inferred data types for table tests-examples/55-tests/tables/9-1.txt: ['string', 'string', 'string']
[     1.612][MainProcess][INFO] Inferred data types for table tests-examples/55-tests/tables/9-2.txt: ['string', 'string']
[     1.616][MainProcess][INFO] Inferred data types for table tests-examples/55-tests/tables/9.out: ['string', 'int64']
[     1.644][MainProcess][DEBUG] Generating DSL...
[     1.670][MainProcess][INFO] Creating 4 processes
[     1.718][cube-solver-0][DEBUG] Initialising process for 2 lines of code.
[     1.721][cube-solver-1][DEBUG] Initialising process for 2 lines of code.
[     1.724][cube-solver-2][DEBUG] Initialising process for 2 lines of code.
[     1.726][cube-solver-3][DEBUG] Initialising process for 2 lines of code.
[     2.185][cube-solver-1][WARNING] There is no solution for current loc (2).
[     2.185][cube-solver-1][DEBUG] Solving cube (l0 = filter(), l1 = summarise())
[     2.187][MainProcess][DEBUG] Increasing generator loc to 3
[     2.187][cube-solver-1][DEBUG] Initialising process for 3 lines of code.
[     2.189][cube-solver-2][WARNING] There is no solution for current loc (2).
[     2.190][cube-solver-2][DEBUG] Solving cube (l0 = filter(), l1 = mutate())
[     2.192][cube-solver-3][WARNING] There is no solution for current loc (2).
[     2.193][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter())
[     2.194][cube-solver-3][DEBUG] Initialising process for 3 lines of code.
[     2.195][cube-solver-2][DEBUG] Initialising process for 3 lines of code.
[     2.197][cube-solver-0][WARNING] There is no solution for current loc (2).
[     2.198][cube-solver-0][DEBUG] Solving cube (l0 = summarise(), l1 = filter())
[     2.203][cube-solver-0][DEBUG] Initialising process for 3 lines of code.
[     3.076][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = filter(), l2 = mutate())
[     3.104][cube-solver-1][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise(), l2 = filter())
[     3.109][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(), l1 = mutate(), l2 = filter())
[     3.157][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = filter(), l2 = summarise())
[     4.043][cube-solver-3][DEBUG] Solving cube (l0 = natural_join3(), l1 = summarise(), l2 = filter())
[     4.045][cube-solver-3][DEBUG] Solving cube (l0 = natural_join3(), l1 = filter(), l2 = summarise())
[     4.048][cube-solver-3][DEBUG] Solving cube (l0 = natural_join3(), l1 = filter(), l2 = mutate())
[     4.050][cube-solver-3][DEBUG] Solving cube (l0 = natural_join3(), l1 = mutate(), l2 = filter())
[     4.052][cube-solver-3][DEBUG] Solving cube (l0 = natural_join4(), l1 = summarise(), l2 = filter())
[     4.055][cube-solver-3][DEBUG] Solving cube (l0 = natural_join4(), l1 = filter(), l2 = summarise())
[     4.057][cube-solver-3][DEBUG] Solving cube (l0 = natural_join4(), l1 = filter(), l2 = mutate())
[     4.059][cube-solver-3][DEBUG] Solving cube (l0 = natural_join4(), l1 = mutate(), l2 = filter())
[     4.061][cube-solver-3][DEBUG] Solving cube (l0 = summarise(), l1 = natural_join(), l2 = filter())
[     4.177][cube-solver-0][DEBUG] Solving cube (l0 = summarise([2]), l1 = natural_join3(), l2 = filter())
[     4.613][cube-solver-1][DEBUG] Solving cube (l0 = summarise([8]), l1 = natural_join4(), l2 = filter())
[     4.624][cube-solver-1][DEBUG] Solving cube (l0 = summarise([8]), l1 = summarise([8]), l2 = filter())
[     4.635][cube-solver-1][DEBUG] Solving cube (l0 = summarise([8]), l1 = filter(), l2 = natural_join())
[     5.724][cube-solver-2][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = natural_join3())
[     6.998][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = natural_join4())
[     7.015][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = summarise([11]))
[     7.029][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = filter([2]))
[     7.039][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = anti_join())
[     7.621][cube-solver-1][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = left_join())
[    10.159][cube-solver-1][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = union())
[    14.318][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = intersect())
[    15.079][cube-solver-1][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = semi_join())
[    16.205][cube-solver-1][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = cross_join())
[    17.207][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = mutate())
[    17.227][cube-solver-3][DEBUG] Solving cube (l0 = summarise([11]), l1 = filter([2]), l2 = inner_join())
[    26.168][cube-solver-0][DEBUG] Solving cube (l0 = summarise([11]), l1 = anti_join(), l2 = filter([2]))
[    32.261][cube-solver-0][DEBUG] Solving cube (l0 = summarise([11]), l1 = left_join(), l2 = filter([2]))
[    34.532][cube-solver-0][DEBUG] Solving cube (l0 = summarise([11]), l1 = union(), l2 = filter([2]))
[    39.011][cube-solver-0][DEBUG] Solving cube (l0 = summarise([11]), l1 = intersect(), l2 = filter([2]))
[    41.434][cube-solver-0][DEBUG] Solving cube (l0 = summarise([11]), l1 = semi_join(), l2 = filter([2]))
[    42.211][cube-solver-0][DEBUG] Solving cube (l0 = summarise([11]), l1 = cross_join(), l2 = filter([2]))
[    42.224][cube-solver-2][DEBUG] Solving cube (l0 = summarise([11]), l1 = mutate(), l2 = filter([2]))
[    42.231][cube-solver-2][DEBUG] Solving cube (l0 = summarise([11]), l1 = inner_join(), l2 = filter([2]))
[   124.167][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join(), l2 = summarise([11]))
[   126.584][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join(), l2 = mutate())
[   127.493][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join3(), l2 = summarise([11]))
[   129.758][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join3(), l2 = mutate())
[   132.519][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join4(), l2 = summarise([11]))
[   132.527][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = natural_join4(), l2 = mutate())
[   132.530][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = natural_join())
[   134.326][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = natural_join3())
[   134.897][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = natural_join4())
[   134.905][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = summarise([11]))
[   134.915][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = filter([2]))
[   134.922][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = anti_join())
[   135.896][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = left_join())
[   139.219][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = union())
[   143.084][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = intersect())
[   145.304][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = semi_join())
[   146.440][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = cross_join())
[   146.776][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = mutate())
[   146.784][cube-solver-0][DEBUG] Solving cube (l0 = filter([2]), l1 = summarise([11]), l2 = inner_join())
[   150.992][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = filter([2]), l2 = summarise([11]))
[   151.000][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = filter([2]), l2 = mutate())
[   151.004][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = anti_join(), l2 = summarise([11]))
[   157.282][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = anti_join(), l2 = mutate())
[   158.582][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = left_join(), l2 = summarise([11]))
[   161.134][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = left_join(), l2 = mutate())
[   162.090][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = union(), l2 = summarise([11]))
[   164.577][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = union(), l2 = mutate())
[   165.541][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = intersect(), l2 = summarise([11]))
[   168.433][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = intersect(), l2 = mutate())
[   168.707][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = semi_join(), l2 = summarise([11]))
[   169.958][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = semi_join(), l2 = mutate())
[   170.412][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = cross_join(), l2 = summarise([11]))
[   188.909][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = cross_join(), l2 = mutate())
[   198.310][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = natural_join())
[   200.114][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = natural_join3())
[   213.813][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = natural_join4())
[   247.048][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = summarise([11]))
[   247.055][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = filter([2]))
[   247.058][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = anti_join())
[   249.213][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = left_join())
[   251.124][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = union())
[   252.923][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = intersect())
[   253.507][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = semi_join())
[   254.159][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = cross_join())
[   267.176][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = mutate())
[   267.179][cube-solver-2][DEBUG] Solving cube (l0 = filter([2]), l1 = mutate(), l2 = inner_join())
[   274.946][cube-solver-3][DEBUG] Solving cube (l0 = filter([2]), l1 = inner_join(), l2 = summarise([11]))
[   276.699][cube-solver-1][DEBUG] Solving cube (l0 = filter([2]), l1 = inner_join(), l2 = mutate())
[   287.421][cube-solver-0][DEBUG] Solving cube (l0 = anti_join(), l1 = summarise([11]), l2 = filter([2]))
[   293.261][cube-solver-0][DEBUG] Solving cube (l0 = anti_join([8]), l1 = filter([2]), l2 = summarise([11]))
[   297.502][cube-solver-0][DEBUG] Solving cube (l0 = anti_join([15]), l1 = filter([2]), l2 = mutate())
[   298.548][cube-solver-0][DEBUG] Solving cube (l0 = anti_join([18]), l1 = mutate(), l2 = filter([2]))
[   299.456][cube-solver-0][DEBUG] Solving cube (l0 = left_join(), l1 = summarise([11]), l2 = filter([2]))
[   300.817][cube-solver-0][DEBUG] Solving cube (l0 = left_join(), l1 = filter([2]), l2 = summarise([11]))
[   301.512][cube-solver-1][DEBUG] Solving cube (l0 = left_join(), l1 = filter([2]), l2 = mutate())
[   302.440][cube-solver-1][DEBUG] Solving cube (l0 = left_join(), l1 = mutate(), l2 = filter([2]))
[   303.297][cube-solver-0][DEBUG] Solving cube (l0 = union(), l1 = summarise([11]), l2 = filter([2]))
[   303.467][cube-solver-1][DEBUG] Solving cube (l0 = union(), l1 = filter([2]), l2 = summarise([11]))
[   304.624][cube-solver-0][DEBUG] Solving cube (l0 = union(), l1 = filter([2]), l2 = mutate())
[   305.560][cube-solver-0][DEBUG] Solving cube (l0 = union(), l1 = mutate(), l2 = filter([2]))
[   305.913][cube-solver-1][DEBUG] Solving cube (l0 = intersect(), l1 = summarise([11]), l2 = filter([2]))
[   306.533][cube-solver-0][DEBUG] Solving cube (l0 = intersect([6]), l1 = filter([2]), l2 = summarise([11]))
[   307.194][cube-solver-0][DEBUG] Solving cube (l0 = intersect([8]), l1 = filter([2]), l2 = mutate())
[   307.202][cube-solver-0][DEBUG] Solving cube (l0 = intersect([8]), l1 = mutate(), l2 = filter([2]))
[   307.209][cube-solver-0][DEBUG] Solving cube (l0 = semi_join(), l1 = summarise([11]), l2 = filter([2]))
[   307.954][cube-solver-0][DEBUG] Solving cube (l0 = semi_join(), l1 = filter([2]), l2 = summarise([11]))
[   308.555][cube-solver-1][DEBUG] Solving cube (l0 = semi_join(), l1 = filter([2]), l2 = mutate())
[   308.892][cube-solver-1][DEBUG] Solving cube (l0 = semi_join(), l1 = mutate(), l2 = filter([2]))
[   308.929][cube-solver-0][DEBUG] Solving cube (l0 = cross_join(), l1 = summarise([11]), l2 = filter([2]))
[   309.263][cube-solver-1][DEBUG] Solving cube (l0 = cross_join([2]), l1 = filter([2]), l2 = summarise([11]))
[   319.307][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([273]), l1 = filter([2]), l2 = mutate())
[   322.032][cube-solver-2][DEBUG] Solving cube (l0 = cross_join([386]), l1 = mutate(), l2 = filter([2]))
[   322.189][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join(), l2 = filter([2]))
[   324.120][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join3(), l2 = filter([2]))
[   329.888][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = natural_join4(), l2 = filter([2]))
[   329.972][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = summarise([11]), l2 = filter([2]))
[   329.989][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = natural_join())
[   331.938][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = natural_join3())
[   346.365][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = natural_join4())
[   367.522][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = summarise([11]))
[   367.659][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = filter([2]))
[   368.097][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = anti_join([18]))
[   370.869][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = left_join())
[   372.769][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = union())
[   374.733][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = intersect([8]))
[   375.503][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = semi_join())
[   376.261][cube-solver-3][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = cross_join([386]))
[   381.015][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = mutate())
[   381.027][cube-solver-2][DEBUG] Solving cube (l0 = mutate(), l1 = filter([2]), l2 = inner_join())
[   395.250][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = anti_join([18]), l2 = filter([2]))
[   397.169][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = left_join(), l2 = filter([2]))
[   397.358][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = union(), l2 = filter([2]))
[   399.184][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = intersect([8]), l2 = filter([2]))
[   399.192][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = semi_join(), l2 = filter([2]))
[   399.826][cube-solver-0][DEBUG] Solving cube (l0 = mutate(), l1 = cross_join([386]), l2 = filter([2]))
[   399.847][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = mutate(), l2 = filter([2]))
[   399.850][cube-solver-1][DEBUG] Solving cube (l0 = mutate(), l1 = inner_join(), l2 = filter([2]))
[   404.191][cube-solver-3][DEBUG] Solving cube (l0 = inner_join(), l1 = summarise([11]), l2 = filter([2]))
[   419.038][cube-solver-0][DEBUG] Solving cube (l0 = inner_join([6]), l1 = filter([2]), l2 = summarise([11]))
[   436.200][cube-solver-2][DEBUG] Solving cube (l0 = inner_join([18]), l1 = filter([2]), l2 = mutate())
[   450.013][cube-solver-1][DEBUG] Solving cube (l0 = inner_join([156]), l1 = mutate(), l2 = filter([2]))
[   459.867][MainProcess][DEBUG] Increasing generator loc to 4
[   459.868][cube-solver-2][DEBUG] Initialising process for 4 lines of code.
[   461.446][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = natural_join(), l3 = filter([2]))
[   471.446][cube-solver-1][DEBUG] Initialising process for 4 lines of code.
[   473.007][cube-solver-1][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = natural_join3(), l3 = filter([2]))
[   488.517][cube-solver-3][DEBUG] Initialising process for 4 lines of code.
[   489.930][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = natural_join4(), l3 = filter([2]))
[   489.968][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = summarise([11]), l3 = filter([2]))
[   490.004][cube-solver-3][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = natural_join())
[   506.951][cube-solver-0][DEBUG] Initialising process for 4 lines of code.
[   508.254][cube-solver-0][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = natural_join3())
[   513.728][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = natural_join4())
[   513.739][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = summarise([11]))
[   520.875][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = filter([2]))
[   523.756][cube-solver-1][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = anti_join([18]))
[   523.930][cube-solver-2][DEBUG] Solving cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = left_join())
[   525.380][cube-solver-1][DEBUG] Found solution with cube (l0 = natural_join(), l1 = summarise([11]), l2 = filter([2]), l3 = anti_join([18]))
[   525.381][MainProcess][INFO] Statistics:
[   525.382][MainProcess][INFO] 	Generated cubes: 153
[   525.382][MainProcess][INFO] 	Attempted programs: 105581
[   525.382][MainProcess][INFO] 		Rejected: 6540
[   525.382][MainProcess][INFO] 		Failed: 99040
[   525.383][MainProcess][INFO] 	Blacklist clauses: 646
[   525.383][MainProcess][DEBUG] Printing statistics for good programs of size 3
[   525.425][MainProcess][DEBUG] 	0: Counter({'filter': 49984, 'summarise': 29368, 'mutate': 25264, 'inner_join': 17664, 'natural_join': 832, 'anti_join': 832, 'left_join': 832, 'union': 832, 'semi_join': 248})
[   525.463][MainProcess][DEBUG] 	1: Counter({'filter': 42528, 'summarise': 26864, 'inner_join': 24696, 'mutate': 20328, 'natural_join3': 6176, 'union': 1600, 'natural_join': 1184, 'left_join': 1184, 'anti_join': 944, 'semi_join': 352})
[   525.496][MainProcess][DEBUG] 	2: Counter({'filter': 33344, 'inner_join': 30224, 'natural_join3': 19904, 'summarise': 15368, 'natural_join4': 11520, 'mutate': 8664, 'union': 2416, 'natural_join': 1488, 'left_join': 1488, 'anti_join': 960, 'semi_join': 480})
[   525.496][MainProcess][DEBUG] Printing statistics for good programs of size 4
[   525.504][MainProcess][DEBUG] 	0: Counter({'natural_join': 26078})
[   525.510][MainProcess][DEBUG] 	1: Counter({'summarise': 26079})
[   525.517][MainProcess][DEBUG] 	2: Counter({'filter': 9183, 'natural_join': 8576, 'natural_join3': 8320})
[   525.523][MainProcess][DEBUG] 	3: Counter({'filter': 17216, 'natural_join': 5589, 'natural_join3': 2723, 'summarise': 256, 'left_join': 245, 'anti_join': 51})
[   525.523][MainProcess][INFO] Solution found: anti_join(summarise(natural_join(@param0, @param1), n = n(), F_name, Room), filter(summarise(natural_join(@param0, @param1), n = n(), F_name, Room), Room != 'R128'), 'F_name')

------------------------------------- R Solution ---------------------------------------

con <- DBI::dbConnect(RSQLite::SQLite(), ":memory:")
input1 <- read_csv("tests-examples/55-tests/tables/9-1.txt", col_types = cols(ID_class = col_character(),ID_key = col_character(),Room = col_character()))
input1 <- copy_to(con, input1)
input2 <- read_csv("tests-examples/55-tests/tables/9-2.txt", col_types = cols(ID_key = col_character(),F_name = col_character()))
input2 <- copy_to(con, input2)
expected_output <- read_csv("tests-examples/55-tests/tables/9.out", col_types = cols(F_name = col_character(),n = col_integer()))

df3 <- inner_join(input1, input2)
df4 <- df3 %>% group_by(F_name, Room) %>% summarise(n = n()) %>% ungroup()
df5 <- df4 %>% filter(Room != 'R128')
df6 <- anti_join(df4, df5, by=c('F_name'))
out <- df6 %>% select(F_name, n) %>% arrange(F_name)


+++++++++++++++++++++++++++++++++++++ SQL Solution +++++++++++++++++++++++++++++++++++++

SELECT `F_name`,
       `n`
FROM
  (SELECT *
   FROM
     (SELECT `F_name`,
             `Room`,
             COUNT() AS `n`
      FROM
        (SELECT `LHS`.`ID_class` AS `ID_class`,
                `LHS`.`ID_key` AS `ID_key`,
                `LHS`.`Room` AS `Room`,
                `RHS`.`F_name` AS `F_name`
         FROM `input1` AS `LHS`
         INNER JOIN `input2` AS `RHS` ON (`LHS`.`ID_key` = `RHS`.`ID_key`))
      GROUP BY `F_name`,
               `Room`) AS `LHS`
   WHERE NOT EXISTS
       (SELECT 1
        FROM
          (SELECT *
           FROM
             (SELECT `F_name`,
                     `Room`,
                     COUNT() AS `n`
              FROM
                (SELECT `LHS`.`ID_class` AS `ID_class`,
                        `LHS`.`ID_key` AS `ID_key`,
                        `LHS`.`Room` AS `Room`,
                        `RHS`.`F_name` AS `F_name`
                 FROM `input1` AS `LHS`
                 INNER JOIN `input2` AS `RHS` ON (`LHS`.`ID_key` = `RHS`.`ID_key`))
              GROUP BY `F_name`,
                       `Room`)
           WHERE (`Room` != 'R128')) AS RHS
        WHERE (LHS.F_name = RHS.F_name) ))
ORDER BY F_name
