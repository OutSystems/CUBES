inputs:
  - tests-examples/sqlsynthesizer/tables/05-1.txt
  - tests-examples/sqlsynthesizer/tables/05-2.txt
output: tests-examples/sqlsynthesizer/tables/05.out
aggrs:
  - n
loc: '2'
comment: |
  Select t1.entryid, Count_Distinct(t1.result) As count_distinct_result
  From input2 As t1
  Group By t1.entryid

  df1 <- input2 %>% group_by(entryid) %>% summarise(n = n()) %>% ungroup()
  df2 <- inner_join(inner_join(input2, input1), df1)
  out <- df2 %>% select(entryid, n) %>% distinct()
