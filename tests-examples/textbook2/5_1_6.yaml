inputs:
#  - 'tests-examples/textbook2/tables/student.csv'
  - 'tests-examples/textbook2/tables/class.csv'
  - 'tests-examples/textbook2/tables/enrolled.csv'
  - 'tests-examples/textbook2/tables/faculty.csv'
output: 'tests-examples/textbook2/tables/5_1_6.csv'
const:
  - 5
aggrs:
  - n
comment: |
  SELECT DISTINCT F.fname
  FROM Faculty F
  WHERE 5 > (SELECT COUNT(E.snum)
             FROM Class C,
                  Enrolled E
             WHERE C.name = E.cname
               AND C.fid = F.fid)

  POSSIBLY NOT OPTIMAL

  df1 <- inner_join(input2, input1)
  df2 <- df1 %>% group_by(cname, fid) %>% summarise(n = n()) %>% ungroup()
  df3 <- df2 %>% filter(n >= 5)
  df4 <- anti_join(input3, df3)
  out <- df4 %>% select(fname = fname)