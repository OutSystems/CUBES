inputs:
#  - 'tests-examples/textbook2/tables/student.csv'
  - 'tests-examples/textbook2/tables/class.csv'
#  - 'tests-examples/textbook2/tables/enrolled.csv'
  - 'tests-examples/textbook2/tables/faculty.csv'
output: 'tests-examples/textbook2/tables/5_1_9.csv'
const:
  - R128
aggrs:
  - n
attrs:
  - room
comment: |
  SELECT F.fname, COUNT(*)
  FROM Faculty F,
       Class C
  WHERE F.fid = C.fid
  GROUP BY F.fid, F.fname
  HAVING EVERY(C.room = 'R128')

  df1 <- inner_join(input1, input2)
  df2 <- df1 %>% group_by(fid, fname) %>% summarise(n = n()) %>% ungroup()
  df3 <- input1 %>% filter(room != 'R128')
  df4 <- anti_join(df2, df3)
  out <- df4 %>% select(fname = fname, n = n) %>% distinct()