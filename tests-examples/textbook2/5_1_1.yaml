inputs:
  - 'tests-examples/textbook2/tables/student.csv'
  - 'tests-examples/textbook2/tables/class.csv'
  - 'tests-examples/textbook2/tables/enrolled.csv'
  - 'tests-examples/textbook2/tables/faculty.csv'
output: 'tests-examples/textbook2/tables/5_1_1.csv'
const:
  - 'Ivana Teach'
  - JR
attrs:
  - level
  - fname
loc: 2
comment: |
  SELECT DISTINCT S.sname
  FROM student S,
       class C,
       enrolled E,
       faculty F
  WHERE S.snum = E.snum
    AND E.cname = C.name
    AND C.fid = F.fid
    AND F.fname = 'Ivana Teach'
    AND S.level = 'JR';

  df1 <- inner_join(inner_join(inner_join(input3, input2), input4), input1)
  df2 <- df1 %>% filter(fname == 'Ivana Teach' & level == 'JR')
  out <- df2 %>% select(sname)