inputs:
- tests-examples/55-tests/tables/aircraft.txt
- tests-examples/55-tests/tables/certified.txt
output: tests-examples/55-tests/tables/25.out
const:
- '3'
aggrs:
- n
- max
attrs:
- crusingrange
bools:
- '>'
loc: '6'
comment: |
  5.3.2 optimal solution sql

  SELECT C.eid, MAX(A.crusingrange)
  FROM  certified C, aircraft A
  WHERE C.aid = A.aid
  GROUP BY C.eid
  HAVING   COUNT(*)  > 3


  out <- inner_join(
  inner_join(certified, aircraft) %>%
  group_by(eid)  %>% summarise(maxcrusingrange = max(crusingrange)),
  filter(
  inner_join(certified,  aircraft) %>%
  group_by(eid) %>% summarise(n = n()), n >3)) %>% select(eid)

  ALTERNATIVE SOLUTION?

  RET_DF10192 <- bind_rows(input2, input1)
  RET_DF10193 <- RET_DF10192 %>% group_by(aname, eid) %>% summarise(n = n())
  RET_DF10194 <- RET_DF10193 %>% ungroup() %>% filter(n > 3)
  RET_DF10195 <- RET_DF10194 %>% ungroup() %>% select(eid)
