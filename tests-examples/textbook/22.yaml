inputs:
- tests-examples/textbook/tables/22-1.txt
- tests-examples/textbook/tables/22-2.txt
- tests-examples/textbook/tables/22-3.txt
output: tests-examples/textbook/tables/22.out
const:
- green
aggrs:
- n
attrs:
- color
bools:
- '!='
loc: '7'
comment: "# 5.2.10 optimal solution\n\ncatalog <- read.table(\"tests-examples/textbook/tables/17-1.txt\"\
  , sep =\",\", header=T)\ncatalog\nsuppliers <- read.table(\"tests-examples/textbook/tables/17-3.txt\"\
  , sep =\",\", header=T)\nsuppliers\ndatout <- read.table(\"tests-examples/textbook/tables/22.out\"\
  , sep =\",\", header=T)\ndatout\n\ninput=inner_join(parts,catalog) %>% inner_join(suppliers)\n\
  df1=input %>%\n    filter(color != \"green\") %>% select(sname)\ndf2=input %>% select(sname)\n\
  df3=anti_join(df2,df1)\ndf4=input %>% \n\tgroup_by(sname) %>% summarise(n = n())\n\
  inner_join(df4,df3)"
