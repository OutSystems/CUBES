inputs:
  - tests-examples/scythe/recent_posts/tables/007.csv
output: tests-examples/scythe/recent_posts/tables/007_o.csv
aggrs:
  - max
  - min
attrs:
  - FromDate
  - ToDate
dateorder: mdy
loc: 2
comment: |
  select t1.Employee, t1.mindt, t2.maxdt, t1.code
  from
  (select min(FromDate), Code, Employee
  from t
  group by Employee, Code) t1
  join
  (select max(ToDate), Code, Employee
  from t
  group by Employee, Code) t2
  on t1.code = t2.code

  df1 <- input1 %>% group_by(Code) %>% summarise(minFromDate = min(FromDate)) %>% ungroup()
  df2 <- input1 %>% group_by(Code) %>% summarise(maxToDate = max(ToDate)) %>% ungroup()
  df3 <- inner_join(inner_join(input1, df1), df2)
  out <- df3 %>% select(Employee, minFromDate, maxToDate, Code) %>% distinct()
