{
    "inputs": [
        "tests-examples/scythe/recent_posts/tables/16-2.txt"
    ],
    "output": "tests-examples/scythe/recent_posts/tables/16.out",
    "const": [
        "1",
        "10192016"
    ],
    "aggrs": [
        "max",
        "n"
    ],
    "attrs": [
        "ReportDt"
    ],
    "loc": "4",
    "comment": "#solution\n\nSELECT C.Id,\n       MAX(RP.PullDt) as LastReportPullDt, \n       COUNT(*) AS ReportCount\nFROM Customer C\nINNER JOIN ReportPull RP ON C.CustomerId = RP.CustomerId\nGROUP BY C.CustomerId\nHAVING COUNT(*) > 1\nAND MAX(RP.PullDt) >= \"10/19/2016\"\n\nR solution: \n\ndat0 <- read.table(\"tests-examples/scythe/recent_posts/tables/16-1.txt\", sep =\",\", header=T)\ndat1 <- read.table(\"tests-examples/scythe/recent_posts/tables/16-2.txt\", sep =\",\", header=T)\ndatout <- read.table(\"tests-examples/scythe/recent_posts/tables/16.out\", sep =\",\", header=T)\nout <- select(\nfilter(\ninner_join(\nsummarise(\ninner_join(dat0,dat1) %>% group_by(CustomerId), n = n()),\nsummarise(dat1 %>% group_by(CustomerId), maxReportDt = max(ReportDt))), n > 1 & maxReportDt >= 10192016) %>% ungroup(), CustomerId,maxReportDt,n)\n\nhttp://stackoverflow.com/questions/40131555/getting-latest-date-with-field-count\n\ntests-examples/scythe/recent_posts/tables/16-1.txt not used"
}