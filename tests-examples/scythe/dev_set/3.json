{
    "inputs": [
        "tests-examples/scythe/dev_set/tables/03-1.txt"
    ],
    "output": "tests-examples/scythe/dev_set/tables/03.out",
    "const": [],
    "aggrs": [
        "max",
        "min"
    ],
    "attrs": [
        "total",
        "id"
    ],
    "loc": "2",
    "comment": "#solution\n\nSELECT MIN(x.id),\n         x.customer, \n         x.total\n    FROM PURCHASES x\n    JOIN (SELECT p.customer,\n                 MAX(total) AS max_total\n            FROM PURCHASES p\n        GROUP BY p.customer) y ON y.customer = x.customer\n                              AND y.max_total = x.total\nGROUP BY x.customer, x.total\n\nSelect *\nFrom (SELECT p.customer, p.total, MIN(p.id) AS min_id\n      From PURCHASES\n      GROUP BY p.customer, p.total) x\nJOIN (SELECT p.customer, MAX(total) AS max_total\n\t\t\t FROM PURCHASES p\n\t\t\t GROUP BY p.customer) y \nON y.customer = x.customer AND y.max_total = x.total\n"
}