inputs:
  - tests-examples/scythe/top_rated_posts/tables/i034.csv
output: tests-examples/scythe/top_rated_posts/tables/o034.csv
aggrs:
  - max
attrs:
  - Time
comment: |
  SELECT t.Train, t.Dest, r.MaxTime
  FROM (
        SELECT Train, MAX(Time) as MaxTime
        FROM TrainTable
        GROUP BY Train
  ) r
  INNER JOIN TrainTable t
  ON t.Train = r.Train AND t.Time = r.MaxTime

  df2 <- input1 %>% group_by(Train) %>% summarise(maxTime = max(Time)) %>% ungroup()
  df3 <- input1 %>% group_by(Dest, Time) %>% summarise(maxTime = max(Time)) %>% ungroup()
  df4 <- inner_join(df2, df3)
  out <- df4 %>% select(Train, Dest, Time)