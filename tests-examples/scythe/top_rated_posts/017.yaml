inputs:
  - tests-examples/scythe/top_rated_posts/tables/i017.csv
output: tests-examples/scythe/top_rated_posts/tables/o017.csv
functions:
  - min
columns:
  - ID
  - SKU
filters:
  - like
constants:
  - "FOO-"
loc: 3
solution:
  - summarise
  - cross_join
  - filter
comment: |
  SELECT t.*
  FROM TestData t
  INNER JOIN (SELECT
                  MIN(ID) as MinID
                  FROM TestData
                  WHERE SKU LIKE 'FOO-%'
             ) dt ON t.ID=dt.MinID

  df1 <- df_i017 %>% group_by(PRODUCT) %>% summarise(ID = min(ID)) %>% ungroup()
  df2 <- full_join(df1, df_i017, by=character(), suffix = c("", ".other")) %>% filter(ID >= ID.other)
  df3 <- df2 %>% filter(str_detect(SKU, 'FOO-'))
  out <- df3 %>% select(ID = ID.other, SKU, PRODUCT = PRODUCT.other) %>% distinct() %>% arrange(ID)