inputs:
  - tests-examples/scythe/top_rated_posts/tables/i017.csv
output: tests-examples/scythe/top_rated_posts/tables/o017.csv
aggrs:
  - min
attrs:
  - ID
  - SKU
filters:
  - like
const:
  - "FOO-"
comment: |
  SELECT t.*
  FROM TestData t
  INNER JOIN (SELECT
                  MIN(ID) as MinID
                  FROM TestData
                  WHERE SKU LIKE 'FOO-%'
             ) dt ON t.ID=dt.MinID

  df1 <- input1 %>% filter(str_detect(SKU, 'FOO-'))
  df2 <- input1 %>% group_by(PRODUCT) %>% summarise(minID = min(ID)) %>% ungroup()
  df3 <- inner_join(df1, df2, by=c('ID' = 'minID','minID' = 'minID'), suffix = c("", ".other"))
  out <- df3 %>% select(ID, SKU, PRODUCT) %>% distinct()