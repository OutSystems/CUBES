inputs:
  - tests-examples/scythe/top_rated_posts/tables/i032.csv
output: tests-examples/scythe/top_rated_posts/tables/o032.csv
constants:
  - Active
  - Inactive
columns:
  - Status
solution:
  - filter
  - inner_join
  - filter
sql: |
  select t1.section, t1.cnt, t2.cnt
  from (select * from t where status = "Active") t1
  join (select * from t where status = "Inactive") t2
  on t1.section = t2.section
comment: |
  df1 <- df_i032 %>% filter(Status == 'Inactive')
  df2 <- inner_join(df_i032, df1, by=c('Section'), suffix = c('', '.other'))
  df3 <- df2 %>% filter(Status == 'Active' & Status != 'Inactive')
  out <- df3 %>% select(Section, Count, Count.other) %>% arrange(Section)
