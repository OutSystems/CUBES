inputs:
  - tests-examples/scythe/top_rated_posts/tables/i019.csv
output: tests-examples/scythe/top_rated_posts/tables/o019.csv
functions:
  - n
loc: 2
comment: |
  SELECT S.id, S.age, C.cnt
    FROM Students  S
         INNER JOIN (SELECT age, count(age) as cnt
                       FROM Students
                      GROUP BY age) C ON S.age = C.age

  df1 <- input1 %>% group_by(age) %>% summarise(n = n())
  df2 <- inner_join(df1, input1)
  out <- df2 %>% ungroup() %>% select(id,age,n) %>% distinct()